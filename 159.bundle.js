(()=>{"use strict";const e=(e,...t)=>postMessage({type:e,payload:t});globalThis.SharedArrayBuffer?globalThis.Atomics?globalThis.FileSystemHandle&&globalThis.FileSystemDirectoryHandle&&globalThis.FileSystemFileHandle&&globalThis.FileSystemFileHandle.prototype.createSyncAccessHandle&&navigator?.storage?.getDirectory?function(t){const n=function(...e){throw new Error(e.join(" "))};globalThis.window===globalThis?n("This code cannot run from the main thread.","Load it as a Worker from a separate Worker."):navigator?.storage?.getDirectory||n("This API requires navigator.storage.getDirectory.");const s=Object.create(null);s.verbose=1;const a={0:console.error.bind(console),1:console.warn.bind(console),2:console.log.bind(console)},o=(e,...t)=>{s.verbose>e&&a[e]("OPFS asyncer:",...t)},i=(...e)=>o(2,...e),c=(...e)=>o(1,...e),r=(...e)=>o(0,...e),l=Object.create(null);l.reset=()=>{let e;for(e in s.opIds)(t=l[e]=Object.create(null)).count=t.time=t.wait=0;var t;let n=l.s11n=Object.create(null);n=n.serialize=Object.create(null),n.count=n.time=0,n=l.s11n.deserialize=Object.create(null),n.count=n.time=0},l.dump=()=>{let e,t=0,n=0,a=0;for(e in s.opIds){const s=l[e];t+=s.count,n+=s.time,a+=s.wait,s.avgTime=s.count&&s.time?s.time/s.count:0}console.log(globalThis?.location?.href,"metrics for",globalThis?.location?.href,":\n",l,"\nTotal of",t,"op(s) for",n,"ms","approx",a,"ms spent waiting on OPFS APIs."),console.log("Serialization metrics:",l.s11n)};const d=Object.create(null),f=new Set,y=function(e,t){const n=new URL(e,"file://irrelevant").pathname;return t?n.split("/").filter((e=>!!e)):n},u=async function(e,t=!1){const n=y(e,!0),a=n.pop();let o=s.rootDir;for(const e of n)e&&(o=await o.getDirectoryHandle(e,{create:!!t}));return[o,a]},p=async e=>{if(e.syncHandle){i("Closing sync handle for",e.filenameAbs);const t=e.syncHandle;return delete e.syncHandle,delete e.xLock,f.delete(e.fid),t.close()}},b=async e=>{try{await p(e)}catch(t){c("closeSyncHandleNoThrow() ignoring:",t,e)}},m=async()=>{if(f.size)for(const e of f){const t=d[e];await b(t),i("Auto-unlocked",e,t.filenameAbs)}},w=async e=>{if(e.releaseImplicitLocks&&f.has(e.fid))return b(e)};class g extends Error{constructor(e,...t){super([...t,": "+e.name+":",e.message].join(" "),{cause:e}),this.name="GetSyncHandleError"}}g.convertRc=(e,t)=>e instanceof g&&("NoModificationAllowedError"===e.cause.name||"DOMException"===e.cause.name&&0===e.cause.message.indexOf("Access Handles cannot"))?s.sq3Codes.SQLITE_BUSY:t;const O=async(e,t)=>{if(!e.syncHandle){const n=performance.now();i("Acquiring sync handle for",e.filenameAbs);const a=6,o=2*s.asyncIdleWaitTime;let r=1,l=o;for(;;l=o*++r)try{e.syncHandle=await e.fileHandle.createSyncAccessHandle();break}catch(n){if(r===a)throw new g(n,"Error getting sync handle for",t+"().",a,"attempts failed.",e.filenameAbs);c("Error getting sync handle for",t+"(). Waiting",l,"ms and trying again.",e.filenameAbs,n),Atomics.wait(s.sabOPView,s.opIds.retry,0,l)}i("Got",t+"() sync handle for",e.filenameAbs,"in",performance.now()-n,"ms"),e.xLock||(f.add(e.fid),i("Acquired implicit lock for",t+"()",e.fid,e.filenameAbs))}return e.syncHandle},E=(e,t)=>{i(e+"() => notify(",t,")"),Atomics.store(s.sabOPView,s.opIds.rc,t),Atomics.notify(s.sabOPView,s.opIds.rc)},h=function(e,t){t.readOnly&&n(e+"(): File is read-only: "+t.filenameAbs)},x=Object.create(null);x.op=void 0,x.start=void 0;const I=e=>{x.start=performance.now(),x.op=e,++l[e].count},S=()=>l[x.op].time+=performance.now()-x.start,T=Object.create(null);T.op=void 0,T.start=void 0;const R=e=>{T.start=performance.now(),T.op=e},A=()=>l[T.op].wait+=performance.now()-T.start;let L=!1;const C={"opfs-async-metrics":async()=>{I("opfs-async-metrics"),l.dump(),E("opfs-async-metrics",0),S()},"opfs-async-shutdown":async()=>{L=!0,E("opfs-async-shutdown",0)},mkdir:async e=>{I("mkdir");let t=0;R("mkdir");try{await u(e+"/filepart",!0)}catch(e){s.s11n.storeException(2,e),t=s.sq3Codes.SQLITE_IOERR}finally{A()}E("mkdir",t),S()},xAccess:async e=>{I("xAccess");let t=0;R("xAccess");try{const[t,n]=await u(e);await t.getFileHandle(n)}catch(e){s.s11n.storeException(2,e),t=s.sq3Codes.SQLITE_IOERR}finally{A()}E("xAccess",t),S()},xClose:async function(e){const t="xClose";I(t),f.delete(e);const n=d[e];let a=0;if(R(t),n){if(delete d[e],await p(n),n.deleteOnClose)try{await n.dirHandle.removeEntry(n.filenamePart)}catch(e){c("Ignoring dirHandle.removeEntry() failure of",n,e)}}else s.s11n.serialize(),a=s.sq3Codes.SQLITE_NOTFOUND;A(),E(t,a),S()},xDelete:async function(...e){I("xDelete");const t=await C.xDeleteNoWait(...e);E("xDelete",t),S()},xDeleteNoWait:async function(e,t=0,n=!1){let a=0;R("xDelete");try{for(;e;){const[s,a]=await u(e,!1);if(!a)break;if(await s.removeEntry(a,{recursive:n}),4660!==t)break;n=!1,(e=y(e,!0)).pop(),e=e.join("/")}}catch(e){s.s11n.storeException(2,e),a=s.sq3Codes.SQLITE_IOERR_DELETE}return A(),a},xFileSize:async function(e){I("xFileSize");const t=d[e];let n=0;R("xFileSize");try{const e=await(await O(t,"xFileSize")).getSize();s.s11n.serialize(Number(e))}catch(e){s.s11n.storeException(1,e),n=g.convertRc(e,s.sq3Codes.SQLITE_IOERR)}await w(t),A(),E("xFileSize",n),S()},xLock:async function(e,t){I("xLock");const n=d[e];let a=0;const o=n.xLock;if(n.xLock=t,!n.syncHandle){R("xLock");try{await O(n,"xLock"),f.delete(e)}catch(e){s.s11n.storeException(1,e),a=g.convertRc(e,s.sq3Codes.SQLITE_IOERR_LOCK),n.xLock=o}A()}E("xLock",a),S()},xOpen:async function(e,t,n,a){const o="xOpen";I(o);const i=s.sq3Codes.SQLITE_OPEN_CREATE&n;R("xOpen");try{let c,r;try{[c,r]=await u(t,!!i)}catch(e){return s.s11n.storeException(1,e),E(o,s.sq3Codes.SQLITE_NOTFOUND),S(),void A()}const l=await c.getFileHandle(r,{create:i});A();const f=Object.assign(Object.create(null),{fid:e,filenameAbs:t,filenamePart:r,dirHandle:c,fileHandle:l,sabView:s.sabFileBufView,readOnly:!i&&s.sq3Codes.SQLITE_OPEN_READONLY&n,deleteOnClose:!!(s.sq3Codes.SQLITE_OPEN_DELETEONCLOSE&n)});f.releaseImplicitLocks=a&s.opfsFlags.OPFS_UNLOCK_ASAP||s.opfsFlags.defaultUnlockAsap,d[e]=f,E(o,0)}catch(e){A(),r(o,e),s.s11n.storeException(1,e),E(o,s.sq3Codes.SQLITE_IOERR)}S()},xRead:async function(e,t,n){I("xRead");let a,o=0;const i=d[e];try{R("xRead"),a=(await O(i,"xRead")).read(i.sabView.subarray(0,t),{at:Number(n)}),A(),a<t&&(i.sabView.fill(0,a,t),o=s.sq3Codes.SQLITE_IOERR_SHORT_READ)}catch(e){void 0===a&&A(),r("xRead() failed",e,i),s.s11n.storeException(1,e),o=g.convertRc(e,s.sq3Codes.SQLITE_IOERR_READ)}await w(i),E("xRead",o),S()},xSync:async function(e,t){I("xSync");const n=d[e];let a=0;if(!n.readOnly&&n.syncHandle){try{R("xSync"),await n.syncHandle.flush()}catch(e){s.s11n.storeException(2,e),a=s.sq3Codes.SQLITE_IOERR_FSYNC}A()}E("xSync",a),S()},xTruncate:async function(e,t){I("xTruncate");let n=0;const a=d[e];R("xTruncate");try{h("xTruncate",a),await(await O(a,"xTruncate")).truncate(t)}catch(e){r("xTruncate():",e,a),s.s11n.storeException(2,e),n=g.convertRc(e,s.sq3Codes.SQLITE_IOERR_TRUNCATE)}await w(a),A(),E("xTruncate",n),S()},xUnlock:async function(e,t){I("xUnlock");let n=0;const a=d[e];if(s.sq3Codes.SQLITE_LOCK_NONE===t&&a.syncHandle){R("xUnlock");try{await p(a)}catch(e){s.s11n.storeException(1,e),n=s.sq3Codes.SQLITE_IOERR_UNLOCK}A()}E("xUnlock",n),S()},xWrite:async function(e,t,n){let a;I("xWrite");const o=d[e];R("xWrite");try{h("xWrite",o),a=t===(await O(o,"xWrite")).write(o.sabView.subarray(0,t),{at:Number(n)})?0:s.sq3Codes.SQLITE_IOERR_WRITE}catch(e){r("xWrite():",e,o),s.s11n.storeException(1,e),a=g.convertRc(e,s.sq3Codes.SQLITE_IOERR_WRITE)}await w(o),A(),E("xWrite",a),S()}},_=async function(){const e=Object.create(null);for(let t of Object.keys(s.opIds)){const n=C[t];if(!n)continue;const a=Object.create(null);e[s.opIds[t]]=a,a.key=t,a.f=n}for(;!L;)try{if("timed-out"===Atomics.wait(s.sabOPView,s.opIds.whichOp,0,s.asyncIdleWaitTime)){await m();continue}const t=Atomics.load(s.sabOPView,s.opIds.whichOp);Atomics.store(s.sabOPView,s.opIds.whichOp,0);const a=e[t]??n("No waitLoop handler for whichOp #",t),o=s.s11n.deserialize(!0)||[];a.f?await a.f(...o):r("Missing callback for opId",t)}catch(e){r("in waitLoop():",e)}};navigator.storage.getDirectory().then((function(t){s.rootDir=t,globalThis.onmessage=function({data:t}){switch(t.type){case"opfs-async-init":{const a=t.args;for(const e in a)s[e]=a[e];s.verbose=a.verbose??1,s.sabOPView=new Int32Array(s.sabOP),s.sabFileBufView=new Uint8Array(s.sabIO,0,s.fileBufferSize),s.sabS11nView=new Uint8Array(s.sabIO,s.sabS11nOffset,s.sabS11nSize),Object.keys(C).forEach((e=>{Number.isFinite(s.opIds[e])||n("Maintenance required: missing state.opIds[",e,"]")})),(()=>{if(s.s11n)return s.s11n;const e=new TextDecoder,t=new TextEncoder("utf-8"),a=new Uint8Array(s.sabIO,s.sabS11nOffset,s.sabS11nSize),o=new DataView(s.sabIO,s.sabS11nOffset,s.sabS11nSize);s.s11n=Object.create(null);const i=Object.create(null);i.number={id:1,size:8,getter:"getFloat64",setter:"setFloat64"},i.bigint={id:2,size:8,getter:"getBigInt64",setter:"setBigInt64"},i.boolean={id:3,size:4,getter:"getInt32",setter:"setInt32"},i.string={id:4};const c=e=>{switch(e){case i.number.id:return i.number;case i.bigint.id:return i.bigint;case i.boolean.id:return i.boolean;case i.string.id:return i.string;default:n("Invalid type ID:",e)}};s.s11n.deserialize=function(t=!1){++l.s11n.deserialize.count;const n=performance.now(),i=a[0],r=i?[]:null;if(i){const t=[];let n,l,d,f=1;for(n=0;n<i;++n,++f)t.push(c(a[f]));for(n=0;n<i;++n){const i=t[n];i.getter?(d=o[i.getter](f,s.littleEndian),f+=i.size):(l=o.getInt32(f,s.littleEndian),f+=4,d=e.decode(a.slice(f,f+l)),f+=l),r.push(d)}}return t&&(a[0]=0),l.s11n.deserialize.time+=performance.now()-n,r},s.s11n.serialize=function(...e){const c=performance.now();if(++l.s11n.serialize.count,e.length){const c=[];let l=0,d=1;for(a[0]=255&e.length;l<e.length;++l,++d)c.push((r=e[l],i[typeof r]||n("Maintenance required: this value type cannot be serialized.",r))),a[d]=c[l].id;for(l=0;l<e.length;++l){const n=c[l];if(n.setter)o[n.setter](d,e[l],s.littleEndian),d+=n.size;else{const n=t.encode(e[l]);o.setInt32(d,n.byteLength,s.littleEndian),d+=4,a.set(n,d),d+=n.byteLength}}}else a[0]=0;var r;l.s11n.serialize.time+=performance.now()-c},s.s11n.storeException=s.asyncS11nExceptions?(e,t)=>{e<=s.asyncS11nExceptions&&s.s11n.serialize([t.name,": ",t.message].join(""))}:()=>{},s.s11n})(),l.reset(),i("init state",s),e("opfs-async-inited"),_();break}case"opfs-async-restart":L&&(c("Restarting after opfs-async-shutdown. Might or might not work."),L=!1,_());break;case"opfs-async-metrics":l.dump()}},e("opfs-async-loaded")})).catch((e=>r("error initializing OPFS asyncer:",e)))}(self):e("opfs-unavailable","Missing required OPFS APIs."):e("opfs-unavailable","Missing Atomics API.","The server must emit the COOP/COEP response headers to enable that."):e("opfs-unavailable","Missing SharedArrayBuffer API.","The server must emit the COOP/COEP response headers to enable that.")})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QkEsRUFBTSxtQkFBb0IsdUJBQ3BCLHVFQUpOQSxFQUFNLG1CQUFvQixpQ0FDcEIsc0UiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zcWxpdGUtd2FzbS1odHRwLy4vZGVwcy9kaXN0L3NxbGl0ZTMtb3Bmcy1hc3luYy1wcm94eS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICAyMDIyLTA5LTE2XG5cbiAgVGhlIGF1dGhvciBkaXNjbGFpbXMgY29weXJpZ2h0IHRvIHRoaXMgc291cmNlIGNvZGUuICBJbiBwbGFjZSBvZiBhXG4gIGxlZ2FsIG5vdGljZSwgaGVyZSBpcyBhIGJsZXNzaW5nOlxuXG4gICogICBNYXkgeW91IGRvIGdvb2QgYW5kIG5vdCBldmlsLlxuICAqICAgTWF5IHlvdSBmaW5kIGZvcmdpdmVuZXNzIGZvciB5b3Vyc2VsZiBhbmQgZm9yZ2l2ZSBvdGhlcnMuXG4gICogICBNYXkgeW91IHNoYXJlIGZyZWVseSwgbmV2ZXIgdGFraW5nIG1vcmUgdGhhbiB5b3UgZ2l2ZS5cblxuICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuXG4gIEEgV29ya2VyIHdoaWNoIG1hbmFnZXMgYXN5bmNocm9ub3VzIE9QRlMgaGFuZGxlcyBvbiBiZWhhbGYgb2YgYVxuICBzeW5jaHJvbm91cyBBUEkgd2hpY2ggY29udHJvbHMgaXQgdmlhIGEgY29tYmluYXRpb24gb2YgV29ya2VyXG4gIG1lc3NhZ2VzLCBTaGFyZWRBcnJheUJ1ZmZlciwgYW5kIEF0b21pY3MuIEl0IGlzIHRoZSBhc3luY2hyb25vdXNcbiAgY291bnRlcnBhcnQgb2YgdGhlIEFQSSBkZWZpbmVkIGluIHNxbGl0ZTMtdmZzLW9wZnMuanMuXG5cbiAgSGlnaGx5IGluZGVidGVkIHRvOlxuXG4gIGh0dHBzOi8vZ2l0aHViLmNvbS9yaGFzaGltb3RvL3dhLXNxbGl0ZS9ibG9iL21hc3Rlci9zcmMvZXhhbXBsZXMvT3JpZ2luUHJpdmF0ZUZpbGVTeXN0ZW1WRlMuanNcblxuICBmb3IgZGVtb25zdHJhdGluZyBob3cgdG8gdXNlIHRoZSBPUEZTIEFQSXMuXG5cbiAgVGhpcyBmaWxlIGlzIHRvIGJlIGxvYWRlZCBhcyBhIFdvcmtlci4gSXQgZG9lcyBub3QgaGF2ZSBhbnkgZGlyZWN0XG4gIGFjY2VzcyB0byB0aGUgc3FsaXRlMyBKUy9XQVNNIGJpdHMsIHNvIGFueSBiaXRzIHdoaWNoIGl0IG5lZWRzIChtb3N0XG4gIG5vdGFibHkgU1FMSVRFX3h4eCBpbnRlZ2VyIGNvZGVzKSBoYXZlIHRvIGJlIGltcG9ydGVkIGludG8gaXQgdmlhIGFuXG4gIGluaXRpYWxpemF0aW9uIHByb2Nlc3MuXG5cbiAgVGhpcyBmaWxlIHJlcHJlc2VudHMgYW4gaW1wbGVtZW50YXRpb24gZGV0YWlsIG9mIGEgbGFyZ2VyIHBpZWNlIG9mXG4gIGNvZGUsIGFuZCBub3QgYSBwdWJsaWMgaW50ZXJmYWNlLiBJdHMgZGV0YWlscyBtYXkgY2hhbmdlIGF0IGFueSB0aW1lXG4gIGFuZCBhcmUgbm90IGludGVuZGVkIHRvIGJlIHVzZWQgYnkgYW55IGNsaWVudC1sZXZlbCBjb2RlLlxuXG4gIDIwMjItMTEtMjc6IENocm9tZSB2MTA4IGNoYW5nZXMgc29tZSBhc3luYyBtZXRob2RzIHRvIHN5bmNocm9ub3VzLCBhc1xuICBkb2N1bWVudGVkIGF0OlxuXG4gIGh0dHBzOi8vZGV2ZWxvcGVyLmNocm9tZS5jb20vYmxvZy9zeW5jLW1ldGhvZHMtZm9yLWFjY2Vzc2hhbmRsZXMvXG5cbiAgV2UgY2Fubm90IGNoYW5nZSB0byB0aGUgc3luYyBmb3JtcyBhdCB0aGlzIHBvaW50IHdpdGhvdXQgYnJlYWtpbmdcbiAgY2xpZW50cyB3aG8gdXNlIENocm9tZSB2MTA0LWlzaCBvciBoaWdoZXIuIHRydW5jYXRlKCksIGdldFNpemUoKSxcbiAgZmx1c2goKSwgYW5kIGNsb3NlKCkgYXJlIG5vdyAoYXMgb2YgdjEwOCkgc3luY2hyb25vdXMuIENhbGxpbmcgdGhlbVxuICB3aXRoIGFuIFwiYXdhaXRcIiwgYXMgd2UgaGF2ZSB0byBmb3IgdGhlIGFzeW5jIGZvcm1zLCBpcyBzdGlsbCBsZWdhbFxuICB3aXRoIHRoZSBzeW5jIGZvcm1zIGJ1dCBpcyBzdXBlcmZsdW91cy4gQ2FsbGluZyB0aGUgYXN5bmMgZm9ybXMgd2l0aFxuICB0aGVGdW5jKCkudGhlbiguLi4pIGlzIG5vdCBjb21wYXRpYmxlIHdpdGggdGhlIGNoYW5nZSB0b1xuICBzeW5jaHJvbm91cywgYnV0IHdlIGRvIGRvIG5vdCB1c2UgdGhvc2UgQVBJcyB0aGF0IHdheS4gaS5lLiB3ZSBkb24ndFxuICBfbmVlZF8gdG8gY2hhbmdlIGFueXRoaW5nIGZvciB0aGlzLCBidXQgYXQgc29tZSBwb2ludCAoYWZ0ZXIgQ2hyb21lXG4gIHZlcnNpb25zIChhcHByb3hpbWF0ZWx5KSAxMDQtMTA3IGFyZSBleHRpbmN0KSBzaG91bGQgY2hhbmdlIG91clxuICB1c2FnZSBvZiB0aG9zZSBtZXRob2RzIHRvIHJlbW92ZSB0aGUgXCJhd2FpdFwiLlxuKi9cblwidXNlIHN0cmljdFwiO1xuY29uc3Qgd1Bvc3QgPSAodHlwZSwuLi5hcmdzKT0+cG9zdE1lc3NhZ2Uoe3R5cGUsIHBheWxvYWQ6YXJnc30pO1xuY29uc3QgaW5zdGFsbEFzeW5jUHJveHkgPSBmdW5jdGlvbihzZWxmKXtcbiAgY29uc3QgdG9zcyA9IGZ1bmN0aW9uKC4uLmFyZ3Mpe3Rocm93IG5ldyBFcnJvcihhcmdzLmpvaW4oJyAnKSl9O1xuICBpZihnbG9iYWxUaGlzLndpbmRvdyA9PT0gZ2xvYmFsVGhpcyl7XG4gICAgdG9zcyhcIlRoaXMgY29kZSBjYW5ub3QgcnVuIGZyb20gdGhlIG1haW4gdGhyZWFkLlwiLFxuICAgICAgICAgXCJMb2FkIGl0IGFzIGEgV29ya2VyIGZyb20gYSBzZXBhcmF0ZSBXb3JrZXIuXCIpO1xuICB9ZWxzZSBpZighbmF2aWdhdG9yPy5zdG9yYWdlPy5nZXREaXJlY3Rvcnkpe1xuICAgIHRvc3MoXCJUaGlzIEFQSSByZXF1aXJlcyBuYXZpZ2F0b3Iuc3RvcmFnZS5nZXREaXJlY3RvcnkuXCIpO1xuICB9XG5cbiAgLyoqXG4gICAgIFdpbGwgaG9sZCBzdGF0ZSBjb3BpZWQgdG8gdGhpcyBvYmplY3QgZnJvbSB0aGUgc3luY3Jvbm91cyBzaWRlIG9mXG4gICAgIHRoaXMgQVBJLlxuICAqL1xuICBjb25zdCBzdGF0ZSA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG5cbiAgLyoqXG4gICAgIHZlcmJvc2U6XG5cbiAgICAgMCA9IG5vIGxvZ2dpbmcgb3V0cHV0XG4gICAgIDEgPSBvbmx5IGVycm9yc1xuICAgICAyID0gd2FybmluZ3MgYW5kIGVycm9yc1xuICAgICAzID0gZGVidWcsIHdhcm5pbmdzLCBhbmQgZXJyb3JzXG4gICovXG4gIHN0YXRlLnZlcmJvc2UgPSAxO1xuXG4gIGNvbnN0IGxvZ2dlcnMgPSB7XG4gICAgMDpjb25zb2xlLmVycm9yLmJpbmQoY29uc29sZSksXG4gICAgMTpjb25zb2xlLndhcm4uYmluZChjb25zb2xlKSxcbiAgICAyOmNvbnNvbGUubG9nLmJpbmQoY29uc29sZSlcbiAgfTtcbiAgY29uc3QgbG9nSW1wbCA9IChsZXZlbCwuLi5hcmdzKT0+e1xuICAgIGlmKHN0YXRlLnZlcmJvc2U+bGV2ZWwpIGxvZ2dlcnNbbGV2ZWxdKFwiT1BGUyBhc3luY2VyOlwiLC4uLmFyZ3MpO1xuICB9O1xuICBjb25zdCBsb2cgPSAgICAoLi4uYXJncyk9PmxvZ0ltcGwoMiwgLi4uYXJncyk7XG4gIGNvbnN0IHdhcm4gPSAgICguLi5hcmdzKT0+bG9nSW1wbCgxLCAuLi5hcmdzKTtcbiAgY29uc3QgZXJyb3IgPSAgKC4uLmFyZ3MpPT5sb2dJbXBsKDAsIC4uLmFyZ3MpO1xuICBjb25zdCBtZXRyaWNzID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgbWV0cmljcy5yZXNldCA9ICgpPT57XG4gICAgbGV0IGs7XG4gICAgY29uc3QgciA9IChtKT0+KG0uY291bnQgPSBtLnRpbWUgPSBtLndhaXQgPSAwKTtcbiAgICBmb3IoayBpbiBzdGF0ZS5vcElkcyl7XG4gICAgICByKG1ldHJpY3Nba10gPSBPYmplY3QuY3JlYXRlKG51bGwpKTtcbiAgICB9XG4gICAgbGV0IHMgPSBtZXRyaWNzLnMxMW4gPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICAgIHMgPSBzLnNlcmlhbGl6ZSA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gICAgcy5jb3VudCA9IHMudGltZSA9IDA7XG4gICAgcyA9IG1ldHJpY3MuczExbi5kZXNlcmlhbGl6ZSA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gICAgcy5jb3VudCA9IHMudGltZSA9IDA7XG4gIH07XG4gIG1ldHJpY3MuZHVtcCA9ICgpPT57XG4gICAgbGV0IGssIG4gPSAwLCB0ID0gMCwgdyA9IDA7XG4gICAgZm9yKGsgaW4gc3RhdGUub3BJZHMpe1xuICAgICAgY29uc3QgbSA9IG1ldHJpY3Nba107XG4gICAgICBuICs9IG0uY291bnQ7XG4gICAgICB0ICs9IG0udGltZTtcbiAgICAgIHcgKz0gbS53YWl0O1xuICAgICAgbS5hdmdUaW1lID0gKG0uY291bnQgJiYgbS50aW1lKSA/IChtLnRpbWUgLyBtLmNvdW50KSA6IDA7XG4gICAgfVxuICAgIGNvbnNvbGUubG9nKGdsb2JhbFRoaXM/LmxvY2F0aW9uPy5ocmVmLFxuICAgICAgICAgICAgICAgIFwibWV0cmljcyBmb3JcIixnbG9iYWxUaGlzPy5sb2NhdGlvbj8uaHJlZixcIjpcXG5cIixcbiAgICAgICAgICAgICAgICBtZXRyaWNzLFxuICAgICAgICAgICAgICAgIFwiXFxuVG90YWwgb2ZcIixuLFwib3AocykgZm9yXCIsdCxcIm1zXCIsXG4gICAgICAgICAgICAgICAgXCJhcHByb3hcIix3LFwibXMgc3BlbnQgd2FpdGluZyBvbiBPUEZTIEFQSXMuXCIpO1xuICAgIGNvbnNvbGUubG9nKFwiU2VyaWFsaXphdGlvbiBtZXRyaWNzOlwiLG1ldHJpY3MuczExbik7XG4gIH07XG5cbiAgLyoqXG4gICAgIF9fb3BlbkZpbGVzIGlzIGEgbWFwIG9mIHNxbGl0ZTNfZmlsZSBwb2ludGVycyAoaW50ZWdlcnMpIHRvXG4gICAgIG1ldGFkYXRhIHJlbGF0ZWQgdG8gYSBnaXZlbiBPUEZTIGZpbGUgaGFuZGxlcy4gVGhlIHBvaW50ZXJzIGFyZSwgaW5cbiAgICAgdGhpcyBzaWRlIG9mIHRoZSBpbnRlcmZhY2UsIG9wYXF1ZSBmaWxlIGhhbmRsZSBJRHMgcHJvdmlkZWQgYnkgdGhlXG4gICAgIHN5bmNocm9ub3VzIHBhcnQgb2YgdGhpcyBjb25zdGVsbGF0aW9uLiBFYWNoIHZhbHVlIGlzIGFuIG9iamVjdFxuICAgICB3aXRoIGEgc3RydWN0dXJlIGRlbW9uc3RyYXRlZCBpbiB0aGUgeE9wZW4oKSBpbXBsLlxuICAqL1xuICBjb25zdCBfX29wZW5GaWxlcyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gIC8qKlxuICAgICBfX2ltcGxpY2l0TG9ja3MgaXMgYSBTZXQgb2Ygc3FsaXRlM19maWxlIHBvaW50ZXJzIChpbnRlZ2Vycykgd2hpY2ggd2VyZVxuICAgICBcImF1dG8tbG9ja2VkXCIuICBpLmUuIHRob3NlIGZvciB3aGljaCB3ZSBvYnRhaW5lZCBhIHN5bmMgYWNjZXNzXG4gICAgIGhhbmRsZSB3aXRob3V0IGFuIGV4cGxpY2l0IHhMb2NrKCkgY2FsbC4gU3VjaCBsb2NrcyB3aWxsIGJlXG4gICAgIHJlbGVhc2VkIGR1cmluZyBkYiBjb25uZWN0aW9uIGlkbGUgdGltZSwgd2hlcmVhcyBhIHN5bmMgYWNjZXNzXG4gICAgIGhhbmRsZSBvYnRhaW5lZCB2aWEgeExvY2soKSwgb3Igc3Vic2VxdWVudGx5IHhMb2NrKCknZCBhZnRlclxuICAgICBhdXRvLWFjcXVpc2l0aW9uLCB3aWxsIG5vdCBiZSByZWxlYXNlZCB1bnRpbCB4VW5sb2NrKCkgaXMgY2FsbGVkLlxuXG4gICAgIE1haW50ZW5hbmNlIHJlbWluZGVyOiBpZiB3ZSByZWxpbnF1aXNoIGF1dG8tbG9ja3MgYXQgdGhlIGVuZCBvZiB0aGVcbiAgICAgb3BlcmF0aW9uIHdoaWNoIGFjcXVpcmVzIHRoZW0sIHdlIHBheSBhIG1hc3NpdmUgcGVyZm9ybWFuY2VcbiAgICAgcGVuYWx0eTogc3BlZWR0ZXN0MSBiZW5jaG1hcmtzIHRha2UgdXAgdG8gNHggYXMgbG9uZy4gQnkgZGVsYXlpbmdcbiAgICAgdGhlIGxvY2sgcmVsZWFzZSB1bnRpbCBpZGxlIHRpbWUsIHRoZSBoaXQgaXMgbmVnbGlnaWJsZS5cbiAgKi9cbiAgY29uc3QgX19pbXBsaWNpdExvY2tzID0gbmV3IFNldCgpO1xuXG4gIC8qKlxuICAgICBFeHBlY3RzIGFuIE9QRlMgZmlsZSBwYXRoLiBJdCBnZXRzIHJlc29sdmVkLCBzdWNoIHRoYXQgXCIuLlwiXG4gICAgIGNvbXBvbmVudHMgYXJlIHByb3Blcmx5IGV4cGFuZGVkLCBhbmQgcmV0dXJuZWQuIElmIHRoZSAybmQgYXJnIGlzXG4gICAgIHRydWUsIHRoZSByZXN1bHQgaXMgcmV0dXJuZWQgYXMgYW4gYXJyYXkgb2YgcGF0aCBlbGVtZW50cywgZWxzZSBhblxuICAgICBhYnNvbHV0ZSBwYXRoIHN0cmluZyBpcyByZXR1cm5lZC5cbiAgKi9cbiAgY29uc3QgZ2V0UmVzb2x2ZWRQYXRoID0gZnVuY3Rpb24oZmlsZW5hbWUsc3BsaXRJdCl7XG4gICAgY29uc3QgcCA9IG5ldyBVUkwoXG4gICAgICBmaWxlbmFtZSwgJ2ZpbGU6Ly9pcnJlbGV2YW50J1xuICAgICkucGF0aG5hbWU7XG4gICAgcmV0dXJuIHNwbGl0SXQgPyBwLnNwbGl0KCcvJykuZmlsdGVyKCh2KT0+ISF2KSA6IHA7XG4gIH07XG5cbiAgLyoqXG4gICAgIFRha2VzIHRoZSBhYnNvbHV0ZSBwYXRoIHRvIGEgZmlsZXN5c3RlbSBlbGVtZW50LiBSZXR1cm5zIGFuIGFycmF5XG4gICAgIG9mIFtoYW5kbGVPZkNvbnRhaW5pbmdEaXIsIGZpbGVuYW1lXS4gSWYgdGhlIDJuZCBhcmd1bWVudCBpcyB0cnV0aHlcbiAgICAgdGhlbiBlYWNoIGRpcmVjdG9yeSBlbGVtZW50IGxlYWRpbmcgdG8gdGhlIGZpbGUgaXMgY3JlYXRlZCBhbG9uZ1xuICAgICB0aGUgd2F5LiBUaHJvd3MgaWYgYW55IGNyZWF0aW9uIG9yIHJlc29sdXRpb24gZmFpbHMuXG4gICovXG4gIGNvbnN0IGdldERpckZvckZpbGVuYW1lID0gYXN5bmMgZnVuY3Rpb24gZihhYnNGaWxlbmFtZSwgY3JlYXRlRGlycyA9IGZhbHNlKXtcbiAgICBjb25zdCBwYXRoID0gZ2V0UmVzb2x2ZWRQYXRoKGFic0ZpbGVuYW1lLCB0cnVlKTtcbiAgICBjb25zdCBmaWxlbmFtZSA9IHBhdGgucG9wKCk7XG4gICAgbGV0IGRoID0gc3RhdGUucm9vdERpcjtcbiAgICBmb3IoY29uc3QgZGlyTmFtZSBvZiBwYXRoKXtcbiAgICAgIGlmKGRpck5hbWUpe1xuICAgICAgICBkaCA9IGF3YWl0IGRoLmdldERpcmVjdG9yeUhhbmRsZShkaXJOYW1lLCB7Y3JlYXRlOiAhIWNyZWF0ZURpcnN9KTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIFtkaCwgZmlsZW5hbWVdO1xuICB9O1xuXG4gIC8qKlxuICAgICBJZiB0aGUgZ2l2ZW4gZmlsZS1ob2xkaW5nIG9iamVjdCBoYXMgYSBzeW5jIGhhbmRsZSBhdHRhY2hlZCB0byBpdCxcbiAgICAgdGhhdCBoYW5kbGUgaXMgcmVtb3ZlIGFuZCBhc3luY2hyb25vdXNseSBjbG9zZWQuIFRob3VnaCBpdCBtYXlcbiAgICAgc291bmQgc2Vuc2libGUgdG8gY29udGludWUgd29yayBhcyBzb29uIGFzIHRoZSBjbG9zZSgpIHJldHVybnNcbiAgICAgKG5vdGluZyB0aGF0IGl0J3MgYXN5bmNocm9ub3VzKSwgZG9pbmcgc28gY2FuIGNhdXNlIG9wZXJhdGlvbnNcbiAgICAgcGVyZm9ybWVkIHNvb24gYWZ0ZXJ3YXJkcywgZS5nLiBhIGNhbGwgdG8gZ2V0U3luY0hhbmRsZSgpIHRvIGZhaWxcbiAgICAgYmVjYXVzZSB0aGV5IG1heSBoYXBwZW4gb3V0IG9mIG9yZGVyIGZyb20gdGhlIGNsb3NlKCkuIE9QRlMgZG9lc1xuICAgICBub3QgZ3VhcmFudHkgdGhhdCB0aGUgYWN0dWFsIG9yZGVyIG9mIG9wZXJhdGlvbnMgaXMgcmV0YWluZWQgaW5cbiAgICAgc3VjaCBjYXNlcy4gaS5lLiAgYWx3YXlzIFwiYXdhaXRcIiBvbiB0aGUgcmVzdWx0IG9mIHRoaXMgZnVuY3Rpb24uXG4gICovXG4gIGNvbnN0IGNsb3NlU3luY0hhbmRsZSA9IGFzeW5jIChmaCk9PntcbiAgICBpZihmaC5zeW5jSGFuZGxlKXtcbiAgICAgIGxvZyhcIkNsb3Npbmcgc3luYyBoYW5kbGUgZm9yXCIsZmguZmlsZW5hbWVBYnMpO1xuICAgICAgY29uc3QgaCA9IGZoLnN5bmNIYW5kbGU7XG4gICAgICBkZWxldGUgZmguc3luY0hhbmRsZTtcbiAgICAgIGRlbGV0ZSBmaC54TG9jaztcbiAgICAgIF9faW1wbGljaXRMb2Nrcy5kZWxldGUoZmguZmlkKTtcbiAgICAgIHJldHVybiBoLmNsb3NlKCk7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgICBBIHByb3h5IGZvciBjbG9zZVN5bmNIYW5kbGUoKSB3aGljaCBpcyBndWFyYW50ZWVkIHRvIG5vdCB0aHJvdy5cblxuICAgICBUaGlzIGZ1bmN0aW9uIGlzIHBhcnQgb2YgYSBsb2NrL3VubG9jayBzdGVwIGluIGZ1bmN0aW9ucyB3aGljaFxuICAgICByZXF1aXJlIGEgc3luYyBhY2Nlc3MgaGFuZGxlIGJ1dCBtYXkgYmUgY2FsbGVkIHdpdGhvdXQgeExvY2soKVxuICAgICBoYXZpbmcgYmVlbiBjYWxsZWQgZmlyc3QuIFN1Y2ggY2FsbHMgbmVlZCB0byByZWxlYXNlIHRoYXRcbiAgICAgaGFuZGxlIHRvIGF2b2lkIGxvY2tpbmcgdGhlIGZpbGUgZm9yIGFsbCBvZiB0aW1lLiBUaGlzIGlzIGFuXG4gICAgIF9hdHRlbXB0XyBhdCByZWR1Y2luZyBjcm9zcy10YWIgY29udGVudGlvbiBidXQgaXQgbWF5IHByb3ZlXG4gICAgIHRvIGJlIG1vcmUgb2YgYSBwcm9ibGVtIHRoYW4gYSBzb2x1dGlvbiBhbmQgbWF5IG5lZWQgdG8gYmVcbiAgICAgcmVtb3ZlZC5cbiAgKi9cbiAgY29uc3QgY2xvc2VTeW5jSGFuZGxlTm9UaHJvdyA9IGFzeW5jIChmaCk9PntcbiAgICB0cnl7YXdhaXQgY2xvc2VTeW5jSGFuZGxlKGZoKX1cbiAgICBjYXRjaChlKXtcbiAgICAgIHdhcm4oXCJjbG9zZVN5bmNIYW5kbGVOb1Rocm93KCkgaWdub3Jpbmc6XCIsZSxmaCk7XG4gICAgfVxuICB9O1xuXG4gIC8qIFJlbGVhc2UgYWxsIGF1dG8tbG9ja3MuICovXG4gIGNvbnN0IHJlbGVhc2VJbXBsaWNpdExvY2tzID0gYXN5bmMgKCk9PntcbiAgICBpZihfX2ltcGxpY2l0TG9ja3Muc2l6ZSl7XG4gICAgICAvKiBSZWxlYXNlIGFsbCBhdXRvLWxvY2tzLiAqL1xuICAgICAgZm9yKGNvbnN0IGZpZCBvZiBfX2ltcGxpY2l0TG9ja3Mpe1xuICAgICAgICBjb25zdCBmaCA9IF9fb3BlbkZpbGVzW2ZpZF07XG4gICAgICAgIGF3YWl0IGNsb3NlU3luY0hhbmRsZU5vVGhyb3coZmgpO1xuICAgICAgICBsb2coXCJBdXRvLXVubG9ja2VkXCIsZmlkLGZoLmZpbGVuYW1lQWJzKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAgIEFuIGV4cGVyaW1lbnQgaW4gaW1wcm92aW5nIGNvbmN1cnJlbmN5IGJ5IGZyZWVpbmcgdXAgaW1wbGljaXQgbG9ja3NcbiAgICAgc29vbmVyLiBUaGlzIGlzIGtub3duIHRvIGltcGFjdCBwZXJmb3JtYW5jZSBkcmFtYXRpY2FsbHkgYnV0IGl0IGhhc1xuICAgICBhbHNvIHNob3duIHRvIGltcHJvdmUgY29uY3VycmVuY3kgY29uc2lkZXJhYmx5LlxuXG4gICAgIElmIGZoLnJlbGVhc2VJbXBsaWNpdExvY2tzIGlzIHRydXRoeSBhbmQgZmggaXMgaW4gX19pbXBsaWNpdExvY2tzLFxuICAgICB0aGlzIHJvdXRpbmUgcmV0dXJucyBjbG9zZVN5bmNIYW5kbGVOb1Rocm93KCksIGVsc2UgaXQgaXMgYSBuby1vcC5cbiAgKi9cbiAgY29uc3QgcmVsZWFzZUltcGxpY2l0TG9jayA9IGFzeW5jIChmaCk9PntcbiAgICBpZihmaC5yZWxlYXNlSW1wbGljaXRMb2NrcyAmJiBfX2ltcGxpY2l0TG9ja3MuaGFzKGZoLmZpZCkpe1xuICAgICAgcmV0dXJuIGNsb3NlU3luY0hhbmRsZU5vVGhyb3coZmgpO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICAgQW4gZXJyb3IgY2xhc3Mgc3BlY2lmaWNhbGx5IGZvciB1c2Ugd2l0aCBnZXRTeW5jSGFuZGxlKCksIHRoZSBnb2FsXG4gICAgIG9mIHdoaWNoIGlzIHRvIGV2ZW50dWFsbHkgYmUgYWJsZSB0byBkaXN0aW5ndWlzaCB1bmFtYmlndW91c2x5XG4gICAgIGJldHdlZW4gbG9ja2luZy1yZWxhdGVkIGZhaWx1cmVzIGFuZCBvdGhlciB0eXBlcywgbm90aW5nIHRoYXQgd2VcbiAgICAgY2Fubm90IGN1cnJlbnRseSBkbyBzbyBiZWNhdXNlIGNyZWF0ZVN5bmNBY2Nlc3NIYW5kbGUoKSBkb2VzIG5vdFxuICAgICBkZWZpbmUgaXRzIGV4Y2VwdGlvbnMgaW4gdGhlIHJlcXVpcmVkIGxldmVsIG9mIGRldGFpbC5cblxuICAgICAyMDIyLTExLTI5OiBhY2NvcmRpbmcgdG86XG5cbiAgICAgaHR0cHM6Ly9naXRodWIuY29tL3doYXR3Zy9mcy9wdWxsLzIxXG5cbiAgICAgTm9Nb2RpZmljYXRpb25BbGxvd2VkRXJyb3Igd2lsbCBiZSB0aGUgc3RhbmRhcmQgZXhjZXB0aW9uIHRocm93blxuICAgICB3aGVuIGFjcXVpc2l0aW9uIG9mIGEgc3luYyBhY2Nlc3MgaGFuZGxlIGZhaWxzIGR1ZSB0byBhIGxvY2tpbmdcbiAgICAgZXJyb3IuIEFzIG9mIHRoaXMgd3JpdGluZywgdGhhdCBlcnJvciB0eXBlIGlzIG5vdCB2aXNpYmxlIGluIHRoZVxuICAgICBkZXYgY29uc29sZSBpbiBDaHJvbWUgdjEwOSwgbm9yIGlzIGl0IGRvY3VtZW50ZWQgaW4gTUROLCBidXQgYW5cbiAgICAgZXJyb3Igd2l0aCB0aGF0IFwibmFtZVwiIHByb3BlcnR5IGlzIGJlaW5nIHRocm93biBmcm9tIHRoZSBPUEZTXG4gICAgIGxheWVyLlxuICAqL1xuICBjbGFzcyBHZXRTeW5jSGFuZGxlRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gICAgY29uc3RydWN0b3IoZXJyb3JPYmplY3QsIC4uLm1zZyl7XG4gICAgICBzdXBlcihbXG4gICAgICAgIC4uLm1zZywgJzogJytlcnJvck9iamVjdC5uYW1lKyc6JyxcbiAgICAgICAgZXJyb3JPYmplY3QubWVzc2FnZVxuICAgICAgXS5qb2luKCcgJyksIHtcbiAgICAgICAgY2F1c2U6IGVycm9yT2JqZWN0XG4gICAgICB9KTtcbiAgICAgIHRoaXMubmFtZSA9ICdHZXRTeW5jSGFuZGxlRXJyb3InO1xuICAgIH1cbiAgfTtcbiAgR2V0U3luY0hhbmRsZUVycm9yLmNvbnZlcnRSYyA9IChlLHJjKT0+e1xuICAgIGlmKDEpe1xuICAgICAgcmV0dXJuIChcbiAgICAgICAgZSBpbnN0YW5jZW9mIEdldFN5bmNIYW5kbGVFcnJvclxuICAgICAgICAgICYmICgoZS5jYXVzZS5uYW1lPT09J05vTW9kaWZpY2F0aW9uQWxsb3dlZEVycm9yJylcbiAgICAgICAgICAgICAgLyogSW5jb25zaXN0ZW50IGV4Y2VwdGlvbi5uYW1lIGZyb20gQ2hyb21lL2l1bSB3aXRoIHRoZVxuICAgICAgICAgICAgICAgICBzYW1lIGV4Y2VwdGlvbi5tZXNzYWdlIHRleHQ6ICovXG4gICAgICAgICAgICAgIHx8IChlLmNhdXNlLm5hbWU9PT0nRE9NRXhjZXB0aW9uJ1xuICAgICAgICAgICAgICAgICAgJiYgMD09PWUuY2F1c2UubWVzc2FnZS5pbmRleE9mKCdBY2Nlc3MgSGFuZGxlcyBjYW5ub3QnKSkpXG4gICAgICApID8gKFxuICAgICAgICAvKmNvbnNvbGUud2FybihcIlNRTElURV9CVVNZXCIsZSksKi9cbiAgICAgICAgc3RhdGUuc3EzQ29kZXMuU1FMSVRFX0JVU1lcbiAgICAgICkgOiByYztcbiAgICB9ZWxzZXtcbiAgICAgIHJldHVybiByYztcbiAgICB9XG4gIH1cbiAgLyoqXG4gICAgIFJldHVybnMgdGhlIHN5bmMgYWNjZXNzIGhhbmRsZSBhc3NvY2lhdGVkIHdpdGggdGhlIGdpdmVuIGZpbGVcbiAgICAgaGFuZGxlIG9iamVjdCAod2hpY2ggbXVzdCBiZSBhIHZhbGlkIGhhbmRsZSBvYmplY3QsIGFzIGNyZWF0ZWQgYnlcbiAgICAgeE9wZW4oKSksIGxhemlseSBvcGVuaW5nIGl0IGlmIG5lZWRlZC5cblxuICAgICBJbiBvcmRlciB0byBoZWxwIGFsbGV2aWF0ZSBjcm9zcy10YWIgY29udGVudGlvbiBmb3IgYSBkYWJhc2UsIGlmXG4gICAgIGFuIGV4Y2VwdGlvbiBpcyB0aHJvd24gd2hpbGUgYWNxdWlyaW5nIHRoZSBoYW5kbGUsIHRoaXMgcm91dGluZVxuICAgICB3aWxsIHdhaXQgYnJpZWZseSBhbmQgdHJ5IGFnYWluLCB1cCB0byBzb21lIGZpeGVkIG51bWJlciBvZlxuICAgICB0aW1lcy4gSWYgYWNxdWlzaXRpb24gc3RpbGwgZmFpbHMgYXQgdGhhdCBwb2ludCBpdCB3aWxsIGdpdmUgdXBcbiAgICAgYW5kIHByb3BhZ2F0ZSB0aGUgZXhjZXB0aW9uLiBDbGllbnQtbGV2ZWwgY29kZSB3aWxsIHNlZSB0aGF0IGFzXG4gICAgIGFuIEkvTyBlcnJvci5cbiAgKi9cbiAgY29uc3QgZ2V0U3luY0hhbmRsZSA9IGFzeW5jIChmaCxvcE5hbWUpPT57XG4gICAgaWYoIWZoLnN5bmNIYW5kbGUpe1xuICAgICAgY29uc3QgdCA9IHBlcmZvcm1hbmNlLm5vdygpO1xuICAgICAgbG9nKFwiQWNxdWlyaW5nIHN5bmMgaGFuZGxlIGZvclwiLGZoLmZpbGVuYW1lQWJzKTtcbiAgICAgIGNvbnN0IG1heFRyaWVzID0gNixcbiAgICAgICAgICAgIG1zQmFzZSA9IHN0YXRlLmFzeW5jSWRsZVdhaXRUaW1lICogMjtcbiAgICAgIGxldCBpID0gMSwgbXMgPSBtc0Jhc2U7XG4gICAgICBmb3IoOyB0cnVlOyBtcyA9IG1zQmFzZSAqICsraSl7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgLy9pZihpPDMpIHRvc3MoXCJKdXN0IHRlc3RpbmcgZ2V0U3luY0hhbmRsZSgpIHdhaXQtYW5kLXJldHJ5LlwiKTtcbiAgICAgICAgICAvL1RPRE8/IEEgY29uZmlnIG9wdGlvbiB3aGljaCB0ZWxscyBpdCB0byB0aHJvdyBoZXJlXG4gICAgICAgICAgLy9yYW5kb21seSBldmVyeSBub3cgYW5kIHRoZW4sIGZvciB0ZXN0aW5nIHB1cnBvc2VzLlxuICAgICAgICAgIGZoLnN5bmNIYW5kbGUgPSBhd2FpdCBmaC5maWxlSGFuZGxlLmNyZWF0ZVN5bmNBY2Nlc3NIYW5kbGUoKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfWNhdGNoKGUpe1xuICAgICAgICAgIGlmKGkgPT09IG1heFRyaWVzKXtcbiAgICAgICAgICAgIHRocm93IG5ldyBHZXRTeW5jSGFuZGxlRXJyb3IoXG4gICAgICAgICAgICAgIGUsIFwiRXJyb3IgZ2V0dGluZyBzeW5jIGhhbmRsZSBmb3JcIixvcE5hbWUrXCIoKS5cIixtYXhUcmllcyxcbiAgICAgICAgICAgICAgXCJhdHRlbXB0cyBmYWlsZWQuXCIsZmguZmlsZW5hbWVBYnNcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHdhcm4oXCJFcnJvciBnZXR0aW5nIHN5bmMgaGFuZGxlIGZvclwiLG9wTmFtZStcIigpLiBXYWl0aW5nXCIsbXMsXG4gICAgICAgICAgICAgICBcIm1zIGFuZCB0cnlpbmcgYWdhaW4uXCIsZmguZmlsZW5hbWVBYnMsZSk7XG4gICAgICAgICAgQXRvbWljcy53YWl0KHN0YXRlLnNhYk9QVmlldywgc3RhdGUub3BJZHMucmV0cnksIDAsIG1zKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgbG9nKFwiR290XCIsb3BOYW1lK1wiKCkgc3luYyBoYW5kbGUgZm9yXCIsZmguZmlsZW5hbWVBYnMsXG4gICAgICAgICAgJ2luJyxwZXJmb3JtYW5jZS5ub3coKSAtIHQsJ21zJyk7XG4gICAgICBpZighZmgueExvY2spe1xuICAgICAgICBfX2ltcGxpY2l0TG9ja3MuYWRkKGZoLmZpZCk7XG4gICAgICAgIGxvZyhcIkFjcXVpcmVkIGltcGxpY2l0IGxvY2sgZm9yXCIsb3BOYW1lK1wiKClcIixmaC5maWQsZmguZmlsZW5hbWVBYnMpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZmguc3luY0hhbmRsZTtcbiAgfTtcblxuICAvKipcbiAgICAgU3RvcmVzIHRoZSBnaXZlbiB2YWx1ZSBhdCBzdGF0ZS5zYWJPUFZpZXdbc3RhdGUub3BJZHMucmNdIGFuZCB0aGVuXG4gICAgIEF0b21pY3Mubm90aWZ5KCkncyBpdC5cbiAgKi9cbiAgY29uc3Qgc3RvcmVBbmROb3RpZnkgPSAob3BOYW1lLCB2YWx1ZSk9PntcbiAgICBsb2cob3BOYW1lK1wiKCkgPT4gbm90aWZ5KFwiLHZhbHVlLFwiKVwiKTtcbiAgICBBdG9taWNzLnN0b3JlKHN0YXRlLnNhYk9QVmlldywgc3RhdGUub3BJZHMucmMsIHZhbHVlKTtcbiAgICBBdG9taWNzLm5vdGlmeShzdGF0ZS5zYWJPUFZpZXcsIHN0YXRlLm9wSWRzLnJjKTtcbiAgfTtcblxuICAvKipcbiAgICAgVGhyb3dzIGlmIGZoIGlzIGEgZmlsZS1ob2xkaW5nIG9iamVjdCB3aGljaCBpcyBmbGFnZ2VkIGFzIHJlYWQtb25seS5cbiAgKi9cbiAgY29uc3QgYWZmaXJtTm90Uk8gPSBmdW5jdGlvbihvcE5hbWUsZmgpe1xuICAgIGlmKGZoLnJlYWRPbmx5KSB0b3NzKG9wTmFtZStcIigpOiBGaWxlIGlzIHJlYWQtb25seTogXCIrZmguZmlsZW5hbWVBYnMpO1xuICB9O1xuXG4gIC8qKlxuICAgICBXZSB0cmFjayAyIGRpZmZlcmVudCB0aW1lcnM6IHRoZSBcIm1ldHJpY3NcIiB0aW1lciByZWNvcmRzIGhvdyBtdWNoXG4gICAgIHRpbWUgd2Ugc3BlbmQgcGVyZm9ybWluZyB3b3JrLiBUaGUgXCJ3YWl0XCIgdGltZXIgcmVjb3JkcyBob3cgbXVjaFxuICAgICB0aW1lIHdlIHNwZW5kIHdhaXRpbmcgb24gdGhlIHVuZGVybHlpbmcgT1BGUyB0aW1lci4gU2VlIHRoZSBjYWxsc1xuICAgICB0byBtVGltZVN0YXJ0KCksIG1UaW1lRW5kKCksIHdUaW1lU3RhcnQoKSwgYW5kIHdUaW1lRW5kKClcbiAgICAgdGhyb3VnaG91dCB0aGlzIGZpbGUgdG8gc2VlIGhvdyB0aGV5J3JlIHVzZWQuXG4gICovXG4gIGNvbnN0IF9fbVRpbWVyID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgX19tVGltZXIub3AgPSB1bmRlZmluZWQ7XG4gIF9fbVRpbWVyLnN0YXJ0ID0gdW5kZWZpbmVkO1xuICBjb25zdCBtVGltZVN0YXJ0ID0gKG9wKT0+e1xuICAgIF9fbVRpbWVyLnN0YXJ0ID0gcGVyZm9ybWFuY2Uubm93KCk7XG4gICAgX19tVGltZXIub3AgPSBvcDtcbiAgICAvL21ldHJpY3Nbb3BdIHx8IHRvc3MoXCJNYWludGVuYW5jZSByZXF1aXJlZDogbWlzc2luZyBtZXRyaWNzIGZvclwiLG9wKTtcbiAgICArK21ldHJpY3Nbb3BdLmNvdW50O1xuICB9O1xuICBjb25zdCBtVGltZUVuZCA9ICgpPT4oXG4gICAgbWV0cmljc1tfX21UaW1lci5vcF0udGltZSArPSBwZXJmb3JtYW5jZS5ub3coKSAtIF9fbVRpbWVyLnN0YXJ0XG4gICk7XG4gIGNvbnN0IF9fd1RpbWVyID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgX193VGltZXIub3AgPSB1bmRlZmluZWQ7XG4gIF9fd1RpbWVyLnN0YXJ0ID0gdW5kZWZpbmVkO1xuICBjb25zdCB3VGltZVN0YXJ0ID0gKG9wKT0+e1xuICAgIF9fd1RpbWVyLnN0YXJ0ID0gcGVyZm9ybWFuY2Uubm93KCk7XG4gICAgX193VGltZXIub3AgPSBvcDtcbiAgICAvL21ldHJpY3Nbb3BdIHx8IHRvc3MoXCJNYWludGVuYW5jZSByZXF1aXJlZDogbWlzc2luZyBtZXRyaWNzIGZvclwiLG9wKTtcbiAgfTtcbiAgY29uc3Qgd1RpbWVFbmQgPSAoKT0+KFxuICAgIG1ldHJpY3NbX193VGltZXIub3BdLndhaXQgKz0gcGVyZm9ybWFuY2Uubm93KCkgLSBfX3dUaW1lci5zdGFydFxuICApO1xuXG4gIC8qKlxuICAgICBHZXRzIHNldCB0byB0cnVlIGJ5IHRoZSAnb3Bmcy1hc3luYy1zaHV0ZG93bicgY29tbWFuZCB0byBxdWl0IHRoZVxuICAgICB3YWl0IGxvb3AuIFRoaXMgaXMgb25seSBpbnRlbmRlZCBmb3IgZGVidWdnaW5nIHB1cnBvc2VzOiB3ZSBjYW5ub3RcbiAgICAgaW5zcGVjdCB0aGlzIGZpbGUncyBzdGF0ZSB3aGlsZSB0aGUgdGlnaHQgd2FpdExvb3AoKSBpcyBydW5uaW5nIGFuZFxuICAgICBuZWVkIGEgd2F5IHRvIHN0b3AgdGhhdCBsb29wIGZvciBpbnRyb3NwZWN0aW9uIHB1cnBvc2VzLlxuICAqL1xuICBsZXQgZmxhZ0FzeW5jU2h1dGRvd24gPSBmYWxzZTtcblxuICAvKipcbiAgICAgQXN5bmNocm9ub3VzIHdyYXBwZXJzIGZvciBzcWxpdGUzX3ZmcyBhbmQgc3FsaXRlM19pb19tZXRob2RzXG4gICAgIG1ldGhvZHMsIGFzIHdlbGwgYXMgaGVscGVycyBsaWtlIG1rZGlyKCkuIE1haW50ZW5hbmNlIHJlbWluZGVyOlxuICAgICBtZW1iZXJzIGFyZSBpbiBhbHBoYWJldGljYWwgb3JkZXIgdG8gc2ltcGxpZnkgZmluZGluZyB0aGVtLlxuICAqL1xuICBjb25zdCB2ZnNBc3luY0ltcGxzID0ge1xuICAgICdvcGZzLWFzeW5jLW1ldHJpY3MnOiBhc3luYyAoKT0+e1xuICAgICAgbVRpbWVTdGFydCgnb3Bmcy1hc3luYy1tZXRyaWNzJyk7XG4gICAgICBtZXRyaWNzLmR1bXAoKTtcbiAgICAgIHN0b3JlQW5kTm90aWZ5KCdvcGZzLWFzeW5jLW1ldHJpY3MnLCAwKTtcbiAgICAgIG1UaW1lRW5kKCk7XG4gICAgfSxcbiAgICAnb3Bmcy1hc3luYy1zaHV0ZG93bic6IGFzeW5jICgpPT57XG4gICAgICBmbGFnQXN5bmNTaHV0ZG93biA9IHRydWU7XG4gICAgICBzdG9yZUFuZE5vdGlmeSgnb3Bmcy1hc3luYy1zaHV0ZG93bicsIDApO1xuICAgIH0sXG4gICAgbWtkaXI6IGFzeW5jIChkaXJuYW1lKT0+e1xuICAgICAgbVRpbWVTdGFydCgnbWtkaXInKTtcbiAgICAgIGxldCByYyA9IDA7XG4gICAgICB3VGltZVN0YXJ0KCdta2RpcicpO1xuICAgICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgZ2V0RGlyRm9yRmlsZW5hbWUoZGlybmFtZStcIi9maWxlcGFydFwiLCB0cnVlKTtcbiAgICAgIH1jYXRjaChlKXtcbiAgICAgICAgc3RhdGUuczExbi5zdG9yZUV4Y2VwdGlvbigyLGUpO1xuICAgICAgICByYyA9IHN0YXRlLnNxM0NvZGVzLlNRTElURV9JT0VSUjtcbiAgICAgIH1maW5hbGx5e1xuICAgICAgICB3VGltZUVuZCgpO1xuICAgICAgfVxuICAgICAgc3RvcmVBbmROb3RpZnkoJ21rZGlyJywgcmMpO1xuICAgICAgbVRpbWVFbmQoKTtcbiAgICB9LFxuICAgIHhBY2Nlc3M6IGFzeW5jIChmaWxlbmFtZSk9PntcbiAgICAgIG1UaW1lU3RhcnQoJ3hBY2Nlc3MnKTtcbiAgICAgIC8qIE9QRlMgY2Fubm90IHN1cHBvcnQgdGhlIGZ1bGwgcmFuZ2Ugb2YgeEFjY2VzcygpIHF1ZXJpZXNcbiAgICAgICAgIHNxbGl0ZTMgY2FsbHMgZm9yLiBXZSBjYW4gZXNzZW50aWFsbHkganVzdCB0ZWxsIGlmIHRoZSBmaWxlXG4gICAgICAgICBpcyBhY2Nlc3NpYmxlLCBidXQgaWYgaXQgaXMgdGhlbiBpdCdzIGF1dG9tYXRpY2FsbHkgd3JpdGFibGVcbiAgICAgICAgICh1bmxlc3MgaXQncyBsb2NrZWQsIHdoaWNoIHdlIGNhbm5vdCg/KSBrbm93IHdpdGhvdXQgdHJ5aW5nXG4gICAgICAgICB0byBvcGVuIGl0KS4gT1BGUyBkb2VzIG5vdCBoYXZlIHRoZSBub3Rpb24gb2YgcmVhZC1vbmx5LlxuXG4gICAgICAgICBUaGUgcmV0dXJuIHNlbWFudGljcyBvZiB0aGlzIGZ1bmN0aW9uIGRpZmZlciBmcm9tIHNxbGl0ZTMnc1xuICAgICAgICAgeEFjY2VzcyBzZW1hbnRpY3MgYmVjYXVzZSB3ZSBhcmUgbGltaXRlZCBpbiB3aGF0IHdlIGNhblxuICAgICAgICAgY29tbXVuaWNhdGUgYmFjayB0byBvdXIgc3luY2hyb25vdXMgY29tbXVuaWNhdGlvbiBwYXJ0bmVyOiAwID1cbiAgICAgICAgIGFjY2Vzc2libGUsIG5vbi0wIG1lYW5zIG5vdCBhY2Nlc3NpYmxlLlxuICAgICAgKi9cbiAgICAgIGxldCByYyA9IDA7XG4gICAgICB3VGltZVN0YXJ0KCd4QWNjZXNzJyk7XG4gICAgICB0cnl7XG4gICAgICAgIGNvbnN0IFtkaCwgZm5dID0gYXdhaXQgZ2V0RGlyRm9yRmlsZW5hbWUoZmlsZW5hbWUpO1xuICAgICAgICBhd2FpdCBkaC5nZXRGaWxlSGFuZGxlKGZuKTtcbiAgICAgIH1jYXRjaChlKXtcbiAgICAgICAgc3RhdGUuczExbi5zdG9yZUV4Y2VwdGlvbigyLGUpO1xuICAgICAgICByYyA9IHN0YXRlLnNxM0NvZGVzLlNRTElURV9JT0VSUjtcbiAgICAgIH1maW5hbGx5e1xuICAgICAgICB3VGltZUVuZCgpO1xuICAgICAgfVxuICAgICAgc3RvcmVBbmROb3RpZnkoJ3hBY2Nlc3MnLCByYyk7XG4gICAgICBtVGltZUVuZCgpO1xuICAgIH0sXG4gICAgeENsb3NlOiBhc3luYyBmdW5jdGlvbihmaWQvKnNxbGl0ZTNfZmlsZSBwb2ludGVyKi8pe1xuICAgICAgY29uc3Qgb3BOYW1lID0gJ3hDbG9zZSc7XG4gICAgICBtVGltZVN0YXJ0KG9wTmFtZSk7XG4gICAgICBfX2ltcGxpY2l0TG9ja3MuZGVsZXRlKGZpZCk7XG4gICAgICBjb25zdCBmaCA9IF9fb3BlbkZpbGVzW2ZpZF07XG4gICAgICBsZXQgcmMgPSAwO1xuICAgICAgd1RpbWVTdGFydChvcE5hbWUpO1xuICAgICAgaWYoZmgpe1xuICAgICAgICBkZWxldGUgX19vcGVuRmlsZXNbZmlkXTtcbiAgICAgICAgYXdhaXQgY2xvc2VTeW5jSGFuZGxlKGZoKTtcbiAgICAgICAgaWYoZmguZGVsZXRlT25DbG9zZSl7XG4gICAgICAgICAgdHJ5eyBhd2FpdCBmaC5kaXJIYW5kbGUucmVtb3ZlRW50cnkoZmguZmlsZW5hbWVQYXJ0KSB9XG4gICAgICAgICAgY2F0Y2goZSl7IHdhcm4oXCJJZ25vcmluZyBkaXJIYW5kbGUucmVtb3ZlRW50cnkoKSBmYWlsdXJlIG9mXCIsZmgsZSkgfVxuICAgICAgICB9XG4gICAgICB9ZWxzZXtcbiAgICAgICAgc3RhdGUuczExbi5zZXJpYWxpemUoKTtcbiAgICAgICAgcmMgPSBzdGF0ZS5zcTNDb2Rlcy5TUUxJVEVfTk9URk9VTkQ7XG4gICAgICB9XG4gICAgICB3VGltZUVuZCgpO1xuICAgICAgc3RvcmVBbmROb3RpZnkob3BOYW1lLCByYyk7XG4gICAgICBtVGltZUVuZCgpO1xuICAgIH0sXG4gICAgeERlbGV0ZTogYXN5bmMgZnVuY3Rpb24oLi4uYXJncyl7XG4gICAgICBtVGltZVN0YXJ0KCd4RGVsZXRlJyk7XG4gICAgICBjb25zdCByYyA9IGF3YWl0IHZmc0FzeW5jSW1wbHMueERlbGV0ZU5vV2FpdCguLi5hcmdzKTtcbiAgICAgIHN0b3JlQW5kTm90aWZ5KCd4RGVsZXRlJywgcmMpO1xuICAgICAgbVRpbWVFbmQoKTtcbiAgICB9LFxuICAgIHhEZWxldGVOb1dhaXQ6IGFzeW5jIGZ1bmN0aW9uKGZpbGVuYW1lLCBzeW5jRGlyID0gMCwgcmVjdXJzaXZlID0gZmFsc2Upe1xuICAgICAgLyogVGhlIHN5bmNEaXIgZmxhZyBpcywgZm9yIHB1cnBvc2VzIG9mIHRoZSBWRlMgQVBJJ3Mgc2VtYW50aWNzLFxuICAgICAgICAgaWdub3JlZCBoZXJlLiBIb3dldmVyLCBpZiBpdCBoYXMgdGhlIHZhbHVlIDB4MTIzNCB0aGVuOiBhZnRlclxuICAgICAgICAgZGVsZXRpbmcgdGhlIGdpdmVuIGZpbGUsIHJlY3Vyc2l2ZWx5IHRyeSB0byBkZWxldGUgYW55IGVtcHR5XG4gICAgICAgICBkaXJlY3RvcmllcyBsZWZ0IGJlaGluZCBpbiBpdHMgd2FrZSAoaWdub3JpbmcgYW55IGVycm9ycyBhbmRcbiAgICAgICAgIHN0b3BwaW5nIGF0IHRoZSBmaXJzdCBmYWlsdXJlKS5cblxuICAgICAgICAgVGhhdCBzYWlkOiB3ZSBkb24ndCBrbm93IGZvciBzdXJlIHRoYXQgcmVtb3ZlRW50cnkoKSBmYWlscyBpZlxuICAgICAgICAgdGhlIGRpciBpcyBub3QgZW1wdHkgYmVjYXVzZSB0aGUgQVBJIGlzIG5vdCBkb2N1bWVudGVkLiBJdCBoYXMsXG4gICAgICAgICBob3dldmVyLCBhIFwicmVjdXJzaXZlXCIgZmxhZyB3aGljaCBkZWZhdWx0cyB0byBmYWxzZSwgc29cbiAgICAgICAgIHByZXN1bWFibHkgaXQgd2lsbCBmYWlsIGlmIHRoZSBkaXIgaXMgbm90IGVtcHR5IGFuZCB0aGF0IGZsYWdcbiAgICAgICAgIGlzIGZhbHNlLlxuICAgICAgKi9cbiAgICAgIGxldCByYyA9IDA7XG4gICAgICB3VGltZVN0YXJ0KCd4RGVsZXRlJyk7XG4gICAgICB0cnkge1xuICAgICAgICB3aGlsZShmaWxlbmFtZSl7XG4gICAgICAgICAgY29uc3QgW2hEaXIsIGZpbGVuYW1lUGFydF0gPSBhd2FpdCBnZXREaXJGb3JGaWxlbmFtZShmaWxlbmFtZSwgZmFsc2UpO1xuICAgICAgICAgIGlmKCFmaWxlbmFtZVBhcnQpIGJyZWFrO1xuICAgICAgICAgIGF3YWl0IGhEaXIucmVtb3ZlRW50cnkoZmlsZW5hbWVQYXJ0LCB7cmVjdXJzaXZlfSk7XG4gICAgICAgICAgaWYoMHgxMjM0ICE9PSBzeW5jRGlyKSBicmVhaztcbiAgICAgICAgICByZWN1cnNpdmUgPSBmYWxzZTtcbiAgICAgICAgICBmaWxlbmFtZSA9IGdldFJlc29sdmVkUGF0aChmaWxlbmFtZSwgdHJ1ZSk7XG4gICAgICAgICAgZmlsZW5hbWUucG9wKCk7XG4gICAgICAgICAgZmlsZW5hbWUgPSBmaWxlbmFtZS5qb2luKCcvJyk7XG4gICAgICAgIH1cbiAgICAgIH1jYXRjaChlKXtcbiAgICAgICAgc3RhdGUuczExbi5zdG9yZUV4Y2VwdGlvbigyLGUpO1xuICAgICAgICByYyA9IHN0YXRlLnNxM0NvZGVzLlNRTElURV9JT0VSUl9ERUxFVEU7XG4gICAgICB9XG4gICAgICB3VGltZUVuZCgpO1xuICAgICAgcmV0dXJuIHJjO1xuICAgIH0sXG4gICAgeEZpbGVTaXplOiBhc3luYyBmdW5jdGlvbihmaWQvKnNxbGl0ZTNfZmlsZSBwb2ludGVyKi8pe1xuICAgICAgbVRpbWVTdGFydCgneEZpbGVTaXplJyk7XG4gICAgICBjb25zdCBmaCA9IF9fb3BlbkZpbGVzW2ZpZF07XG4gICAgICBsZXQgcmMgPSAwO1xuICAgICAgd1RpbWVTdGFydCgneEZpbGVTaXplJyk7XG4gICAgICB0cnl7XG4gICAgICAgIGNvbnN0IHN6ID0gYXdhaXQgKGF3YWl0IGdldFN5bmNIYW5kbGUoZmgsJ3hGaWxlU2l6ZScpKS5nZXRTaXplKCk7XG4gICAgICAgIHN0YXRlLnMxMW4uc2VyaWFsaXplKE51bWJlcihzeikpO1xuICAgICAgfWNhdGNoKGUpe1xuICAgICAgICBzdGF0ZS5zMTFuLnN0b3JlRXhjZXB0aW9uKDEsZSk7XG4gICAgICAgIHJjID0gR2V0U3luY0hhbmRsZUVycm9yLmNvbnZlcnRSYyhlLHN0YXRlLnNxM0NvZGVzLlNRTElURV9JT0VSUik7XG4gICAgICB9XG4gICAgICBhd2FpdCByZWxlYXNlSW1wbGljaXRMb2NrKGZoKTtcbiAgICAgIHdUaW1lRW5kKCk7XG4gICAgICBzdG9yZUFuZE5vdGlmeSgneEZpbGVTaXplJywgcmMpO1xuICAgICAgbVRpbWVFbmQoKTtcbiAgICB9LFxuICAgIHhMb2NrOiBhc3luYyBmdW5jdGlvbihmaWQvKnNxbGl0ZTNfZmlsZSBwb2ludGVyKi8sXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2tUeXBlLypTUUxJVEVfTE9DS18uLi4qLyl7XG4gICAgICBtVGltZVN0YXJ0KCd4TG9jaycpO1xuICAgICAgY29uc3QgZmggPSBfX29wZW5GaWxlc1tmaWRdO1xuICAgICAgbGV0IHJjID0gMDtcbiAgICAgIGNvbnN0IG9sZExvY2tUeXBlID0gZmgueExvY2s7XG4gICAgICBmaC54TG9jayA9IGxvY2tUeXBlO1xuICAgICAgaWYoICFmaC5zeW5jSGFuZGxlICl7XG4gICAgICAgIHdUaW1lU3RhcnQoJ3hMb2NrJyk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgYXdhaXQgZ2V0U3luY0hhbmRsZShmaCwneExvY2snKTtcbiAgICAgICAgICBfX2ltcGxpY2l0TG9ja3MuZGVsZXRlKGZpZCk7XG4gICAgICAgIH1jYXRjaChlKXtcbiAgICAgICAgICBzdGF0ZS5zMTFuLnN0b3JlRXhjZXB0aW9uKDEsZSk7XG4gICAgICAgICAgcmMgPSBHZXRTeW5jSGFuZGxlRXJyb3IuY29udmVydFJjKGUsc3RhdGUuc3EzQ29kZXMuU1FMSVRFX0lPRVJSX0xPQ0spO1xuICAgICAgICAgIGZoLnhMb2NrID0gb2xkTG9ja1R5cGU7XG4gICAgICAgIH1cbiAgICAgICAgd1RpbWVFbmQoKTtcbiAgICAgIH1cbiAgICAgIHN0b3JlQW5kTm90aWZ5KCd4TG9jaycscmMpO1xuICAgICAgbVRpbWVFbmQoKTtcbiAgICB9LFxuICAgIHhPcGVuOiBhc3luYyBmdW5jdGlvbihmaWQvKnNxbGl0ZTNfZmlsZSBwb2ludGVyKi8sIGZpbGVuYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBmbGFncy8qU1FMSVRFX09QRU5fLi4uKi8sXG4gICAgICAgICAgICAgICAgICAgICAgICAgIG9wZnNGbGFncy8qT1BGU18uLi4qLyl7XG4gICAgICBjb25zdCBvcE5hbWUgPSAneE9wZW4nO1xuICAgICAgbVRpbWVTdGFydChvcE5hbWUpO1xuICAgICAgY29uc3QgY3JlYXRlID0gKHN0YXRlLnNxM0NvZGVzLlNRTElURV9PUEVOX0NSRUFURSAmIGZsYWdzKTtcbiAgICAgIHdUaW1lU3RhcnQoJ3hPcGVuJyk7XG4gICAgICB0cnl7XG4gICAgICAgIGxldCBoRGlyLCBmaWxlbmFtZVBhcnQ7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgW2hEaXIsIGZpbGVuYW1lUGFydF0gPSBhd2FpdCBnZXREaXJGb3JGaWxlbmFtZShmaWxlbmFtZSwgISFjcmVhdGUpO1xuICAgICAgICB9Y2F0Y2goZSl7XG4gICAgICAgICAgc3RhdGUuczExbi5zdG9yZUV4Y2VwdGlvbigxLGUpO1xuICAgICAgICAgIHN0b3JlQW5kTm90aWZ5KG9wTmFtZSwgc3RhdGUuc3EzQ29kZXMuU1FMSVRFX05PVEZPVU5EKTtcbiAgICAgICAgICBtVGltZUVuZCgpO1xuICAgICAgICAgIHdUaW1lRW5kKCk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGhGaWxlID0gYXdhaXQgaERpci5nZXRGaWxlSGFuZGxlKGZpbGVuYW1lUGFydCwge2NyZWF0ZX0pO1xuICAgICAgICB3VGltZUVuZCgpO1xuICAgICAgICBjb25zdCBmaCA9IE9iamVjdC5hc3NpZ24oT2JqZWN0LmNyZWF0ZShudWxsKSx7XG4gICAgICAgICAgZmlkOiBmaWQsXG4gICAgICAgICAgZmlsZW5hbWVBYnM6IGZpbGVuYW1lLFxuICAgICAgICAgIGZpbGVuYW1lUGFydDogZmlsZW5hbWVQYXJ0LFxuICAgICAgICAgIGRpckhhbmRsZTogaERpcixcbiAgICAgICAgICBmaWxlSGFuZGxlOiBoRmlsZSxcbiAgICAgICAgICBzYWJWaWV3OiBzdGF0ZS5zYWJGaWxlQnVmVmlldyxcbiAgICAgICAgICByZWFkT25seTogY3JlYXRlXG4gICAgICAgICAgICA/IGZhbHNlIDogKHN0YXRlLnNxM0NvZGVzLlNRTElURV9PUEVOX1JFQURPTkxZICYgZmxhZ3MpLFxuICAgICAgICAgIGRlbGV0ZU9uQ2xvc2U6ICEhKHN0YXRlLnNxM0NvZGVzLlNRTElURV9PUEVOX0RFTEVURU9OQ0xPU0UgJiBmbGFncylcbiAgICAgICAgfSk7XG4gICAgICAgIGZoLnJlbGVhc2VJbXBsaWNpdExvY2tzID1cbiAgICAgICAgICAob3Bmc0ZsYWdzICYgc3RhdGUub3Bmc0ZsYWdzLk9QRlNfVU5MT0NLX0FTQVApXG4gICAgICAgICAgfHwgc3RhdGUub3Bmc0ZsYWdzLmRlZmF1bHRVbmxvY2tBc2FwO1xuICAgICAgICBpZigwIC8qIHRoaXMgYmxvY2sgaXMgbW9kZWxsZWQgYWZ0ZXIgc29tZXRoaW5nIHdhLXNxbGl0ZVxuICAgICAgICAgICAgICAgIGRvZXMgYnV0IGl0IGxlYWRzIHRvIGltbWVkaWF0ZSBjb250ZW50aW9uIG9uIGpvdXJuYWwgZmlsZXMuXG4gICAgICAgICAgICAgICAgVXBkYXRlOiB0aGlzIGFwcHJvYWNoIHJlcG9ydGVkbHkgb25seSB3b3JrcyBmb3IgREVMRVRFIGpvdXJuYWxcbiAgICAgICAgICAgICAgICBtb2RlLiAqL1xuICAgICAgICAgICAmJiAoMD09PShmbGFncyAmIHN0YXRlLnNxM0NvZGVzLlNRTElURV9PUEVOX01BSU5fREIpKSl7XG4gICAgICAgICAgLyogc3FsaXRlIGRvZXMgbm90IGxvY2sgdGhlc2UgZmlsZXMsIHNvIGdvIGFoZWFkIGFuZCBncmFiIGFuIE9QRlNcbiAgICAgICAgICAgICBsb2NrLiAqL1xuICAgICAgICAgIGZoLnhMb2NrID0gXCJ4T3BlblwiLyogVHJ1dGh5IHZhbHVlIHRvIGtlZXAgZW50cnkgZnJvbSBnZXR0aW5nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmxhZ2dlZCBhcyBhdXRvLWxvY2tlZC4gU3RyaW5nIHZhbHVlIHNvXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhhdCB3ZSBjYW4gZWFzaWx5IGRpc3Rpbmd1aXNoIGlzIGxhdGVyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgbmVlZGVkLiAqLztcbiAgICAgICAgICBhd2FpdCBnZXRTeW5jSGFuZGxlKGZoLCd4T3BlbicpO1xuICAgICAgICB9XG4gICAgICAgIF9fb3BlbkZpbGVzW2ZpZF0gPSBmaDtcbiAgICAgICAgc3RvcmVBbmROb3RpZnkob3BOYW1lLCAwKTtcbiAgICAgIH1jYXRjaChlKXtcbiAgICAgICAgd1RpbWVFbmQoKTtcbiAgICAgICAgZXJyb3Iob3BOYW1lLGUpO1xuICAgICAgICBzdGF0ZS5zMTFuLnN0b3JlRXhjZXB0aW9uKDEsZSk7XG4gICAgICAgIHN0b3JlQW5kTm90aWZ5KG9wTmFtZSwgc3RhdGUuc3EzQ29kZXMuU1FMSVRFX0lPRVJSKTtcbiAgICAgIH1cbiAgICAgIG1UaW1lRW5kKCk7XG4gICAgfSxcbiAgICB4UmVhZDogYXN5bmMgZnVuY3Rpb24oZmlkLypzcWxpdGUzX2ZpbGUgcG9pbnRlciovLG4sb2Zmc2V0NjQpe1xuICAgICAgbVRpbWVTdGFydCgneFJlYWQnKTtcbiAgICAgIGxldCByYyA9IDAsIG5SZWFkO1xuICAgICAgY29uc3QgZmggPSBfX29wZW5GaWxlc1tmaWRdO1xuICAgICAgdHJ5e1xuICAgICAgICB3VGltZVN0YXJ0KCd4UmVhZCcpO1xuICAgICAgICBuUmVhZCA9IChhd2FpdCBnZXRTeW5jSGFuZGxlKGZoLCd4UmVhZCcpKS5yZWFkKFxuICAgICAgICAgIGZoLnNhYlZpZXcuc3ViYXJyYXkoMCwgbiksXG4gICAgICAgICAge2F0OiBOdW1iZXIob2Zmc2V0NjQpfVxuICAgICAgICApO1xuICAgICAgICB3VGltZUVuZCgpO1xuICAgICAgICBpZihuUmVhZCA8IG4pey8qIFplcm8tZmlsbCByZW1haW5pbmcgYnl0ZXMgKi9cbiAgICAgICAgICBmaC5zYWJWaWV3LmZpbGwoMCwgblJlYWQsIG4pO1xuICAgICAgICAgIHJjID0gc3RhdGUuc3EzQ29kZXMuU1FMSVRFX0lPRVJSX1NIT1JUX1JFQUQ7XG4gICAgICAgIH1cbiAgICAgIH1jYXRjaChlKXtcbiAgICAgICAgaWYodW5kZWZpbmVkPT09blJlYWQpIHdUaW1lRW5kKCk7XG4gICAgICAgIGVycm9yKFwieFJlYWQoKSBmYWlsZWRcIixlLGZoKTtcbiAgICAgICAgc3RhdGUuczExbi5zdG9yZUV4Y2VwdGlvbigxLGUpO1xuICAgICAgICByYyA9IEdldFN5bmNIYW5kbGVFcnJvci5jb252ZXJ0UmMoZSxzdGF0ZS5zcTNDb2Rlcy5TUUxJVEVfSU9FUlJfUkVBRCk7XG4gICAgICB9XG4gICAgICBhd2FpdCByZWxlYXNlSW1wbGljaXRMb2NrKGZoKTtcbiAgICAgIHN0b3JlQW5kTm90aWZ5KCd4UmVhZCcscmMpO1xuICAgICAgbVRpbWVFbmQoKTtcbiAgICB9LFxuICAgIHhTeW5jOiBhc3luYyBmdW5jdGlvbihmaWQvKnNxbGl0ZTNfZmlsZSBwb2ludGVyKi8sZmxhZ3MvKmlnbm9yZWQqLyl7XG4gICAgICBtVGltZVN0YXJ0KCd4U3luYycpO1xuICAgICAgY29uc3QgZmggPSBfX29wZW5GaWxlc1tmaWRdO1xuICAgICAgbGV0IHJjID0gMDtcbiAgICAgIGlmKCFmaC5yZWFkT25seSAmJiBmaC5zeW5jSGFuZGxlKXtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICB3VGltZVN0YXJ0KCd4U3luYycpO1xuICAgICAgICAgIGF3YWl0IGZoLnN5bmNIYW5kbGUuZmx1c2goKTtcbiAgICAgICAgfWNhdGNoKGUpe1xuICAgICAgICAgIHN0YXRlLnMxMW4uc3RvcmVFeGNlcHRpb24oMixlKTtcbiAgICAgICAgICByYyA9IHN0YXRlLnNxM0NvZGVzLlNRTElURV9JT0VSUl9GU1lOQztcbiAgICAgICAgfVxuICAgICAgICB3VGltZUVuZCgpO1xuICAgICAgfVxuICAgICAgc3RvcmVBbmROb3RpZnkoJ3hTeW5jJyxyYyk7XG4gICAgICBtVGltZUVuZCgpO1xuICAgIH0sXG4gICAgeFRydW5jYXRlOiBhc3luYyBmdW5jdGlvbihmaWQvKnNxbGl0ZTNfZmlsZSBwb2ludGVyKi8sc2l6ZSl7XG4gICAgICBtVGltZVN0YXJ0KCd4VHJ1bmNhdGUnKTtcbiAgICAgIGxldCByYyA9IDA7XG4gICAgICBjb25zdCBmaCA9IF9fb3BlbkZpbGVzW2ZpZF07XG4gICAgICB3VGltZVN0YXJ0KCd4VHJ1bmNhdGUnKTtcbiAgICAgIHRyeXtcbiAgICAgICAgYWZmaXJtTm90Uk8oJ3hUcnVuY2F0ZScsIGZoKTtcbiAgICAgICAgYXdhaXQgKGF3YWl0IGdldFN5bmNIYW5kbGUoZmgsJ3hUcnVuY2F0ZScpKS50cnVuY2F0ZShzaXplKTtcbiAgICAgIH1jYXRjaChlKXtcbiAgICAgICAgZXJyb3IoXCJ4VHJ1bmNhdGUoKTpcIixlLGZoKTtcbiAgICAgICAgc3RhdGUuczExbi5zdG9yZUV4Y2VwdGlvbigyLGUpO1xuICAgICAgICByYyA9IEdldFN5bmNIYW5kbGVFcnJvci5jb252ZXJ0UmMoZSxzdGF0ZS5zcTNDb2Rlcy5TUUxJVEVfSU9FUlJfVFJVTkNBVEUpO1xuICAgICAgfVxuICAgICAgYXdhaXQgcmVsZWFzZUltcGxpY2l0TG9jayhmaCk7XG4gICAgICB3VGltZUVuZCgpO1xuICAgICAgc3RvcmVBbmROb3RpZnkoJ3hUcnVuY2F0ZScscmMpO1xuICAgICAgbVRpbWVFbmQoKTtcbiAgICB9LFxuICAgIHhVbmxvY2s6IGFzeW5jIGZ1bmN0aW9uKGZpZC8qc3FsaXRlM19maWxlIHBvaW50ZXIqLyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NrVHlwZS8qU1FMSVRFX0xPQ0tfLi4uKi8pe1xuICAgICAgbVRpbWVTdGFydCgneFVubG9jaycpO1xuICAgICAgbGV0IHJjID0gMDtcbiAgICAgIGNvbnN0IGZoID0gX19vcGVuRmlsZXNbZmlkXTtcbiAgICAgIGlmKCBzdGF0ZS5zcTNDb2Rlcy5TUUxJVEVfTE9DS19OT05FPT09bG9ja1R5cGVcbiAgICAgICAgICAmJiBmaC5zeW5jSGFuZGxlICl7XG4gICAgICAgIHdUaW1lU3RhcnQoJ3hVbmxvY2snKTtcbiAgICAgICAgdHJ5IHsgYXdhaXQgY2xvc2VTeW5jSGFuZGxlKGZoKSB9XG4gICAgICAgIGNhdGNoKGUpe1xuICAgICAgICAgIHN0YXRlLnMxMW4uc3RvcmVFeGNlcHRpb24oMSxlKTtcbiAgICAgICAgICByYyA9IHN0YXRlLnNxM0NvZGVzLlNRTElURV9JT0VSUl9VTkxPQ0s7XG4gICAgICAgIH1cbiAgICAgICAgd1RpbWVFbmQoKTtcbiAgICAgIH1cbiAgICAgIHN0b3JlQW5kTm90aWZ5KCd4VW5sb2NrJyxyYyk7XG4gICAgICBtVGltZUVuZCgpO1xuICAgIH0sXG4gICAgeFdyaXRlOiBhc3luYyBmdW5jdGlvbihmaWQvKnNxbGl0ZTNfZmlsZSBwb2ludGVyKi8sbixvZmZzZXQ2NCl7XG4gICAgICBtVGltZVN0YXJ0KCd4V3JpdGUnKTtcbiAgICAgIGxldCByYztcbiAgICAgIGNvbnN0IGZoID0gX19vcGVuRmlsZXNbZmlkXTtcbiAgICAgIHdUaW1lU3RhcnQoJ3hXcml0ZScpO1xuICAgICAgdHJ5e1xuICAgICAgICBhZmZpcm1Ob3RSTygneFdyaXRlJywgZmgpO1xuICAgICAgICByYyA9IChcbiAgICAgICAgICBuID09PSAoYXdhaXQgZ2V0U3luY0hhbmRsZShmaCwneFdyaXRlJykpXG4gICAgICAgICAgICAud3JpdGUoZmguc2FiVmlldy5zdWJhcnJheSgwLCBuKSxcbiAgICAgICAgICAgICAgICAgICB7YXQ6IE51bWJlcihvZmZzZXQ2NCl9KVxuICAgICAgICApID8gMCA6IHN0YXRlLnNxM0NvZGVzLlNRTElURV9JT0VSUl9XUklURTtcbiAgICAgIH1jYXRjaChlKXtcbiAgICAgICAgZXJyb3IoXCJ4V3JpdGUoKTpcIixlLGZoKTtcbiAgICAgICAgc3RhdGUuczExbi5zdG9yZUV4Y2VwdGlvbigxLGUpO1xuICAgICAgICByYyA9IEdldFN5bmNIYW5kbGVFcnJvci5jb252ZXJ0UmMoZSxzdGF0ZS5zcTNDb2Rlcy5TUUxJVEVfSU9FUlJfV1JJVEUpO1xuICAgICAgfVxuICAgICAgYXdhaXQgcmVsZWFzZUltcGxpY2l0TG9jayhmaCk7XG4gICAgICB3VGltZUVuZCgpO1xuICAgICAgc3RvcmVBbmROb3RpZnkoJ3hXcml0ZScscmMpO1xuICAgICAgbVRpbWVFbmQoKTtcbiAgICB9XG4gIH0vKnZmc0FzeW5jSW1wbHMqLztcblxuICBjb25zdCBpbml0UzExbiA9ICgpPT57XG4gICAgLyoqXG4gICAgICAgQUNIVFVORzogdGhpcyBjb2RlIGlzIDEwMCUgZHVwbGljYXRlZCBpbiB0aGUgb3RoZXIgaGFsZiBvZiB0aGlzXG4gICAgICAgcHJveHkhIFRoZSBkb2N1bWVudGF0aW9uIGlzIG1haW50YWluZWQgaW4gdGhlIFwic3luY2hyb25vdXMgaGFsZlwiLlxuICAgICovXG4gICAgaWYoc3RhdGUuczExbikgcmV0dXJuIHN0YXRlLnMxMW47XG4gICAgY29uc3QgdGV4dERlY29kZXIgPSBuZXcgVGV4dERlY29kZXIoKSxcbiAgICAgICAgICB0ZXh0RW5jb2RlciA9IG5ldyBUZXh0RW5jb2RlcigndXRmLTgnKSxcbiAgICAgICAgICB2aWV3VTggPSBuZXcgVWludDhBcnJheShzdGF0ZS5zYWJJTywgc3RhdGUuc2FiUzExbk9mZnNldCwgc3RhdGUuc2FiUzExblNpemUpLFxuICAgICAgICAgIHZpZXdEViA9IG5ldyBEYXRhVmlldyhzdGF0ZS5zYWJJTywgc3RhdGUuc2FiUzExbk9mZnNldCwgc3RhdGUuc2FiUzExblNpemUpO1xuICAgIHN0YXRlLnMxMW4gPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICAgIGNvbnN0IFR5cGVJZHMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICAgIFR5cGVJZHMubnVtYmVyICA9IHsgaWQ6IDEsIHNpemU6IDgsIGdldHRlcjogJ2dldEZsb2F0NjQnLCBzZXR0ZXI6ICdzZXRGbG9hdDY0JyB9O1xuICAgIFR5cGVJZHMuYmlnaW50ICA9IHsgaWQ6IDIsIHNpemU6IDgsIGdldHRlcjogJ2dldEJpZ0ludDY0Jywgc2V0dGVyOiAnc2V0QmlnSW50NjQnIH07XG4gICAgVHlwZUlkcy5ib29sZWFuID0geyBpZDogMywgc2l6ZTogNCwgZ2V0dGVyOiAnZ2V0SW50MzInLCBzZXR0ZXI6ICdzZXRJbnQzMicgfTtcbiAgICBUeXBlSWRzLnN0cmluZyA9ICB7IGlkOiA0IH07XG4gICAgY29uc3QgZ2V0VHlwZUlkID0gKHYpPT4oXG4gICAgICBUeXBlSWRzW3R5cGVvZiB2XVxuICAgICAgICB8fCB0b3NzKFwiTWFpbnRlbmFuY2UgcmVxdWlyZWQ6IHRoaXMgdmFsdWUgdHlwZSBjYW5ub3QgYmUgc2VyaWFsaXplZC5cIix2KVxuICAgICk7XG4gICAgY29uc3QgZ2V0VHlwZUlkQnlJZCA9ICh0aWQpPT57XG4gICAgICBzd2l0Y2godGlkKXtcbiAgICAgICAgICBjYXNlIFR5cGVJZHMubnVtYmVyLmlkOiByZXR1cm4gVHlwZUlkcy5udW1iZXI7XG4gICAgICAgICAgY2FzZSBUeXBlSWRzLmJpZ2ludC5pZDogcmV0dXJuIFR5cGVJZHMuYmlnaW50O1xuICAgICAgICAgIGNhc2UgVHlwZUlkcy5ib29sZWFuLmlkOiByZXR1cm4gVHlwZUlkcy5ib29sZWFuO1xuICAgICAgICAgIGNhc2UgVHlwZUlkcy5zdHJpbmcuaWQ6IHJldHVybiBUeXBlSWRzLnN0cmluZztcbiAgICAgICAgICBkZWZhdWx0OiB0b3NzKFwiSW52YWxpZCB0eXBlIElEOlwiLHRpZCk7XG4gICAgICB9XG4gICAgfTtcbiAgICBzdGF0ZS5zMTFuLmRlc2VyaWFsaXplID0gZnVuY3Rpb24oY2xlYXI9ZmFsc2Upe1xuICAgICAgKyttZXRyaWNzLnMxMW4uZGVzZXJpYWxpemUuY291bnQ7XG4gICAgICBjb25zdCB0ID0gcGVyZm9ybWFuY2Uubm93KCk7XG4gICAgICBjb25zdCBhcmdjID0gdmlld1U4WzBdO1xuICAgICAgY29uc3QgcmMgPSBhcmdjID8gW10gOiBudWxsO1xuICAgICAgaWYoYXJnYyl7XG4gICAgICAgIGNvbnN0IHR5cGVJZHMgPSBbXTtcbiAgICAgICAgbGV0IG9mZnNldCA9IDEsIGksIG4sIHY7XG4gICAgICAgIGZvcihpID0gMDsgaSA8IGFyZ2M7ICsraSwgKytvZmZzZXQpe1xuICAgICAgICAgIHR5cGVJZHMucHVzaChnZXRUeXBlSWRCeUlkKHZpZXdVOFtvZmZzZXRdKSk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yKGkgPSAwOyBpIDwgYXJnYzsgKytpKXtcbiAgICAgICAgICBjb25zdCB0ID0gdHlwZUlkc1tpXTtcbiAgICAgICAgICBpZih0LmdldHRlcil7XG4gICAgICAgICAgICB2ID0gdmlld0RWW3QuZ2V0dGVyXShvZmZzZXQsIHN0YXRlLmxpdHRsZUVuZGlhbik7XG4gICAgICAgICAgICBvZmZzZXQgKz0gdC5zaXplO1xuICAgICAgICAgIH1lbHNley8qU3RyaW5nKi9cbiAgICAgICAgICAgIG4gPSB2aWV3RFYuZ2V0SW50MzIob2Zmc2V0LCBzdGF0ZS5saXR0bGVFbmRpYW4pO1xuICAgICAgICAgICAgb2Zmc2V0ICs9IDQ7XG4gICAgICAgICAgICB2ID0gdGV4dERlY29kZXIuZGVjb2RlKHZpZXdVOC5zbGljZShvZmZzZXQsIG9mZnNldCtuKSk7XG4gICAgICAgICAgICBvZmZzZXQgKz0gbjtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmMucHVzaCh2KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYoY2xlYXIpIHZpZXdVOFswXSA9IDA7XG4gICAgICAvL2xvZyhcImRlc2VyaWFsaXplOlwiLGFyZ2MsIHJjKTtcbiAgICAgIG1ldHJpY3MuczExbi5kZXNlcmlhbGl6ZS50aW1lICs9IHBlcmZvcm1hbmNlLm5vdygpIC0gdDtcbiAgICAgIHJldHVybiByYztcbiAgICB9O1xuICAgIHN0YXRlLnMxMW4uc2VyaWFsaXplID0gZnVuY3Rpb24oLi4uYXJncyl7XG4gICAgICBjb25zdCB0ID0gcGVyZm9ybWFuY2Uubm93KCk7XG4gICAgICArK21ldHJpY3MuczExbi5zZXJpYWxpemUuY291bnQ7XG4gICAgICBpZihhcmdzLmxlbmd0aCl7XG4gICAgICAgIC8vbG9nKFwic2VyaWFsaXplKCk6XCIsYXJncyk7XG4gICAgICAgIGNvbnN0IHR5cGVJZHMgPSBbXTtcbiAgICAgICAgbGV0IGkgPSAwLCBvZmZzZXQgPSAxO1xuICAgICAgICB2aWV3VThbMF0gPSBhcmdzLmxlbmd0aCAmIDB4ZmYgLyogaGVhZGVyID0gIyBvZiBhcmdzICovO1xuICAgICAgICBmb3IoOyBpIDwgYXJncy5sZW5ndGg7ICsraSwgKytvZmZzZXQpe1xuICAgICAgICAgIC8qIFdyaXRlIHRoZSBUeXBlSWRzLmlkIHZhbHVlIGludG8gdGhlIG5leHQgYXJncy5sZW5ndGhcbiAgICAgICAgICAgICBieXRlcy4gKi9cbiAgICAgICAgICB0eXBlSWRzLnB1c2goZ2V0VHlwZUlkKGFyZ3NbaV0pKTtcbiAgICAgICAgICB2aWV3VThbb2Zmc2V0XSA9IHR5cGVJZHNbaV0uaWQ7XG4gICAgICAgIH1cbiAgICAgICAgZm9yKGkgPSAwOyBpIDwgYXJncy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgIC8qIERlc2VyaWFsaXplIHRoZSBmb2xsb3dpbmcgYnl0ZXMgYmFzZWQgb24gdGhlaXJcbiAgICAgICAgICAgICBjb3JyZXNwb25kaW5nIFR5cGVJZHMuaWQgZnJvbSB0aGUgaGVhZGVyLiAqL1xuICAgICAgICAgIGNvbnN0IHQgPSB0eXBlSWRzW2ldO1xuICAgICAgICAgIGlmKHQuc2V0dGVyKXtcbiAgICAgICAgICAgIHZpZXdEVlt0LnNldHRlcl0ob2Zmc2V0LCBhcmdzW2ldLCBzdGF0ZS5saXR0bGVFbmRpYW4pO1xuICAgICAgICAgICAgb2Zmc2V0ICs9IHQuc2l6ZTtcbiAgICAgICAgICB9ZWxzZXsvKlN0cmluZyovXG4gICAgICAgICAgICBjb25zdCBzID0gdGV4dEVuY29kZXIuZW5jb2RlKGFyZ3NbaV0pO1xuICAgICAgICAgICAgdmlld0RWLnNldEludDMyKG9mZnNldCwgcy5ieXRlTGVuZ3RoLCBzdGF0ZS5saXR0bGVFbmRpYW4pO1xuICAgICAgICAgICAgb2Zmc2V0ICs9IDQ7XG4gICAgICAgICAgICB2aWV3VTguc2V0KHMsIG9mZnNldCk7XG4gICAgICAgICAgICBvZmZzZXQgKz0gcy5ieXRlTGVuZ3RoO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvL2xvZyhcInNlcmlhbGl6ZSgpIHJlc3VsdDpcIix2aWV3VTguc2xpY2UoMCxvZmZzZXQpKTtcbiAgICAgIH1lbHNle1xuICAgICAgICB2aWV3VThbMF0gPSAwO1xuICAgICAgfVxuICAgICAgbWV0cmljcy5zMTFuLnNlcmlhbGl6ZS50aW1lICs9IHBlcmZvcm1hbmNlLm5vdygpIC0gdDtcbiAgICB9O1xuXG4gICAgc3RhdGUuczExbi5zdG9yZUV4Y2VwdGlvbiA9IHN0YXRlLmFzeW5jUzExbkV4Y2VwdGlvbnNcbiAgICAgID8gKChwcmlvcml0eSxlKT0+e1xuICAgICAgICBpZihwcmlvcml0eTw9c3RhdGUuYXN5bmNTMTFuRXhjZXB0aW9ucyl7XG4gICAgICAgICAgc3RhdGUuczExbi5zZXJpYWxpemUoW2UubmFtZSwnOiAnLGUubWVzc2FnZV0uam9pbihcIlwiKSk7XG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgICA6ICgpPT57fTtcblxuICAgIHJldHVybiBzdGF0ZS5zMTFuO1xuICB9Lyppbml0UzExbigpKi87XG5cbiAgY29uc3Qgd2FpdExvb3AgPSBhc3luYyBmdW5jdGlvbiBmKCl7XG4gICAgY29uc3Qgb3BIYW5kbGVycyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gICAgZm9yKGxldCBrIG9mIE9iamVjdC5rZXlzKHN0YXRlLm9wSWRzKSl7XG4gICAgICBjb25zdCB2aSA9IHZmc0FzeW5jSW1wbHNba107XG4gICAgICBpZighdmkpIGNvbnRpbnVlO1xuICAgICAgY29uc3QgbyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gICAgICBvcEhhbmRsZXJzW3N0YXRlLm9wSWRzW2tdXSA9IG87XG4gICAgICBvLmtleSA9IGs7XG4gICAgICBvLmYgPSB2aTtcbiAgICB9XG4gICAgd2hpbGUoIWZsYWdBc3luY1NodXRkb3duKXtcbiAgICAgIHRyeSB7XG4gICAgICAgIGlmKCd0aW1lZC1vdXQnPT09QXRvbWljcy53YWl0KFxuICAgICAgICAgIHN0YXRlLnNhYk9QVmlldywgc3RhdGUub3BJZHMud2hpY2hPcCwgMCwgc3RhdGUuYXN5bmNJZGxlV2FpdFRpbWVcbiAgICAgICAgKSl7XG4gICAgICAgICAgYXdhaXQgcmVsZWFzZUltcGxpY2l0TG9ja3MoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBvcElkID0gQXRvbWljcy5sb2FkKHN0YXRlLnNhYk9QVmlldywgc3RhdGUub3BJZHMud2hpY2hPcCk7XG4gICAgICAgIEF0b21pY3Muc3RvcmUoc3RhdGUuc2FiT1BWaWV3LCBzdGF0ZS5vcElkcy53aGljaE9wLCAwKTtcbiAgICAgICAgY29uc3QgaG5kID0gb3BIYW5kbGVyc1tvcElkXSA/PyB0b3NzKFwiTm8gd2FpdExvb3AgaGFuZGxlciBmb3Igd2hpY2hPcCAjXCIsb3BJZCk7XG4gICAgICAgIGNvbnN0IGFyZ3MgPSBzdGF0ZS5zMTFuLmRlc2VyaWFsaXplKFxuICAgICAgICAgIHRydWUgLyogY2xlYXIgczExbiB0byBrZWVwIHRoZSBjYWxsZXIgZnJvbSBjb25mdXNpbmcgdGhpcyB3aXRoXG4gICAgICAgICAgICAgICAgICBhbiBleGNlcHRpb24gc3RyaW5nIHdyaXR0ZW4gYnkgdGhlIHVwY29taW5nXG4gICAgICAgICAgICAgICAgICBvcGVyYXRpb24gKi9cbiAgICAgICAgKSB8fCBbXTtcbiAgICAgICAgLy93YXJuKFwid2FpdExvb3AoKSB3aGljaE9wID1cIixvcElkLCBobmQsIGFyZ3MpO1xuICAgICAgICBpZihobmQuZikgYXdhaXQgaG5kLmYoLi4uYXJncyk7XG4gICAgICAgIGVsc2UgZXJyb3IoXCJNaXNzaW5nIGNhbGxiYWNrIGZvciBvcElkXCIsb3BJZCk7XG4gICAgICB9Y2F0Y2goZSl7XG4gICAgICAgIGVycm9yKCdpbiB3YWl0TG9vcCgpOicsZSk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIG5hdmlnYXRvci5zdG9yYWdlLmdldERpcmVjdG9yeSgpLnRoZW4oZnVuY3Rpb24oZCl7XG4gICAgc3RhdGUucm9vdERpciA9IGQ7XG4gICAgZ2xvYmFsVGhpcy5vbm1lc3NhZ2UgPSBmdW5jdGlvbih7ZGF0YX0pe1xuICAgICAgc3dpdGNoKGRhdGEudHlwZSl7XG4gICAgICAgICAgY2FzZSAnb3Bmcy1hc3luYy1pbml0Jzp7XG4gICAgICAgICAgICAvKiBSZWNlaXZlIHNoYXJlZCBzdGF0ZSBmcm9tIHN5bmNocm9ub3VzIHBhcnRuZXIgKi9cbiAgICAgICAgICAgIGNvbnN0IG9wdCA9IGRhdGEuYXJncztcbiAgICAgICAgICAgIGZvcihjb25zdCBrIGluIG9wdCkgc3RhdGVba10gPSBvcHRba107XG4gICAgICAgICAgICBzdGF0ZS52ZXJib3NlID0gb3B0LnZlcmJvc2UgPz8gMTtcbiAgICAgICAgICAgIHN0YXRlLnNhYk9QVmlldyA9IG5ldyBJbnQzMkFycmF5KHN0YXRlLnNhYk9QKTtcbiAgICAgICAgICAgIHN0YXRlLnNhYkZpbGVCdWZWaWV3ID0gbmV3IFVpbnQ4QXJyYXkoc3RhdGUuc2FiSU8sIDAsIHN0YXRlLmZpbGVCdWZmZXJTaXplKTtcbiAgICAgICAgICAgIHN0YXRlLnNhYlMxMW5WaWV3ID0gbmV3IFVpbnQ4QXJyYXkoc3RhdGUuc2FiSU8sIHN0YXRlLnNhYlMxMW5PZmZzZXQsIHN0YXRlLnNhYlMxMW5TaXplKTtcbiAgICAgICAgICAgIE9iamVjdC5rZXlzKHZmc0FzeW5jSW1wbHMpLmZvckVhY2goKGspPT57XG4gICAgICAgICAgICAgIGlmKCFOdW1iZXIuaXNGaW5pdGUoc3RhdGUub3BJZHNba10pKXtcbiAgICAgICAgICAgICAgICB0b3NzKFwiTWFpbnRlbmFuY2UgcmVxdWlyZWQ6IG1pc3Npbmcgc3RhdGUub3BJZHNbXCIsayxcIl1cIik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaW5pdFMxMW4oKTtcbiAgICAgICAgICAgIG1ldHJpY3MucmVzZXQoKTtcbiAgICAgICAgICAgIGxvZyhcImluaXQgc3RhdGVcIixzdGF0ZSk7XG4gICAgICAgICAgICB3UG9zdCgnb3Bmcy1hc3luYy1pbml0ZWQnKTtcbiAgICAgICAgICAgIHdhaXRMb29wKCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgY2FzZSAnb3Bmcy1hc3luYy1yZXN0YXJ0JzpcbiAgICAgICAgICAgIGlmKGZsYWdBc3luY1NodXRkb3duKXtcbiAgICAgICAgICAgICAgd2FybihcIlJlc3RhcnRpbmcgYWZ0ZXIgb3Bmcy1hc3luYy1zaHV0ZG93bi4gTWlnaHQgb3IgbWlnaHQgbm90IHdvcmsuXCIpO1xuICAgICAgICAgICAgICBmbGFnQXN5bmNTaHV0ZG93biA9IGZhbHNlO1xuICAgICAgICAgICAgICB3YWl0TG9vcCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSAnb3Bmcy1hc3luYy1tZXRyaWNzJzpcbiAgICAgICAgICAgIG1ldHJpY3MuZHVtcCgpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfTtcbiAgICB3UG9zdCgnb3Bmcy1hc3luYy1sb2FkZWQnKTtcbiAgfSkuY2F0Y2goKGUpPT5lcnJvcihcImVycm9yIGluaXRpYWxpemluZyBPUEZTIGFzeW5jZXI6XCIsZSkpO1xufS8qaW5zdGFsbEFzeW5jUHJveHkoKSovO1xuaWYoIWdsb2JhbFRoaXMuU2hhcmVkQXJyYXlCdWZmZXIpe1xuICB3UG9zdCgnb3Bmcy11bmF2YWlsYWJsZScsIFwiTWlzc2luZyBTaGFyZWRBcnJheUJ1ZmZlciBBUEkuXCIsXG4gICAgICAgIFwiVGhlIHNlcnZlciBtdXN0IGVtaXQgdGhlIENPT1AvQ09FUCByZXNwb25zZSBoZWFkZXJzIHRvIGVuYWJsZSB0aGF0LlwiKTtcbn1lbHNlIGlmKCFnbG9iYWxUaGlzLkF0b21pY3Mpe1xuICB3UG9zdCgnb3Bmcy11bmF2YWlsYWJsZScsIFwiTWlzc2luZyBBdG9taWNzIEFQSS5cIixcbiAgICAgICAgXCJUaGUgc2VydmVyIG11c3QgZW1pdCB0aGUgQ09PUC9DT0VQIHJlc3BvbnNlIGhlYWRlcnMgdG8gZW5hYmxlIHRoYXQuXCIpO1xufWVsc2UgaWYoIWdsb2JhbFRoaXMuRmlsZVN5c3RlbUhhbmRsZSB8fFxuICAgICAgICAgIWdsb2JhbFRoaXMuRmlsZVN5c3RlbURpcmVjdG9yeUhhbmRsZSB8fFxuICAgICAgICAgIWdsb2JhbFRoaXMuRmlsZVN5c3RlbUZpbGVIYW5kbGUgfHxcbiAgICAgICAgICFnbG9iYWxUaGlzLkZpbGVTeXN0ZW1GaWxlSGFuZGxlLnByb3RvdHlwZS5jcmVhdGVTeW5jQWNjZXNzSGFuZGxlIHx8XG4gICAgICAgICAhbmF2aWdhdG9yPy5zdG9yYWdlPy5nZXREaXJlY3Rvcnkpe1xuICB3UG9zdCgnb3Bmcy11bmF2YWlsYWJsZScsXCJNaXNzaW5nIHJlcXVpcmVkIE9QRlMgQVBJcy5cIik7XG59ZWxzZXtcbiAgaW5zdGFsbEFzeW5jUHJveHkoc2VsZik7XG59XG4iXSwibmFtZXMiOlsid1Bvc3QiLCJ0eXBlIiwiYXJncyIsInBvc3RNZXNzYWdlIiwicGF5bG9hZCIsImdsb2JhbFRoaXMiLCJTaGFyZWRBcnJheUJ1ZmZlciIsIkF0b21pY3MiLCJGaWxlU3lzdGVtSGFuZGxlIiwiRmlsZVN5c3RlbURpcmVjdG9yeUhhbmRsZSIsIkZpbGVTeXN0ZW1GaWxlSGFuZGxlIiwicHJvdG90eXBlIiwiY3JlYXRlU3luY0FjY2Vzc0hhbmRsZSIsIm5hdmlnYXRvciIsInN0b3JhZ2UiLCJnZXREaXJlY3RvcnkiLCJzZWxmIiwidG9zcyIsIkVycm9yIiwiam9pbiIsIndpbmRvdyIsInN0YXRlIiwiT2JqZWN0IiwiY3JlYXRlIiwidmVyYm9zZSIsImxvZ2dlcnMiLCJjb25zb2xlIiwiZXJyb3IiLCJiaW5kIiwid2FybiIsImxvZyIsImxvZ0ltcGwiLCJsZXZlbCIsIm1ldHJpY3MiLCJyZXNldCIsImsiLCJvcElkcyIsIm0iLCJjb3VudCIsInRpbWUiLCJ3YWl0IiwicyIsInMxMW4iLCJzZXJpYWxpemUiLCJkZXNlcmlhbGl6ZSIsImR1bXAiLCJuIiwidCIsInciLCJhdmdUaW1lIiwibG9jYXRpb24iLCJocmVmIiwiX19vcGVuRmlsZXMiLCJfX2ltcGxpY2l0TG9ja3MiLCJTZXQiLCJnZXRSZXNvbHZlZFBhdGgiLCJmaWxlbmFtZSIsInNwbGl0SXQiLCJwIiwiVVJMIiwicGF0aG5hbWUiLCJzcGxpdCIsImZpbHRlciIsInYiLCJnZXREaXJGb3JGaWxlbmFtZSIsImFzeW5jIiwiYWJzRmlsZW5hbWUiLCJjcmVhdGVEaXJzIiwicGF0aCIsInBvcCIsImRoIiwicm9vdERpciIsImRpck5hbWUiLCJnZXREaXJlY3RvcnlIYW5kbGUiLCJjbG9zZVN5bmNIYW5kbGUiLCJmaCIsInN5bmNIYW5kbGUiLCJmaWxlbmFtZUFicyIsImgiLCJ4TG9jayIsImRlbGV0ZSIsImZpZCIsImNsb3NlIiwiY2xvc2VTeW5jSGFuZGxlTm9UaHJvdyIsImUiLCJyZWxlYXNlSW1wbGljaXRMb2NrcyIsInNpemUiLCJyZWxlYXNlSW1wbGljaXRMb2NrIiwiaGFzIiwiR2V0U3luY0hhbmRsZUVycm9yIiwiY29uc3RydWN0b3IiLCJlcnJvck9iamVjdCIsIm1zZyIsInN1cGVyIiwibmFtZSIsIm1lc3NhZ2UiLCJjYXVzZSIsInRoaXMiLCJjb252ZXJ0UmMiLCJyYyIsImluZGV4T2YiLCJzcTNDb2RlcyIsImdldFN5bmNIYW5kbGUiLCJvcE5hbWUiLCJwZXJmb3JtYW5jZSIsIm5vdyIsIm1heFRyaWVzIiwibXNCYXNlIiwiYXN5bmNJZGxlV2FpdFRpbWUiLCJpIiwibXMiLCJmaWxlSGFuZGxlIiwic2FiT1BWaWV3IiwicmV0cnkiLCJhZGQiLCJzdG9yZUFuZE5vdGlmeSIsInZhbHVlIiwic3RvcmUiLCJub3RpZnkiLCJhZmZpcm1Ob3RSTyIsInJlYWRPbmx5IiwiX19tVGltZXIiLCJvcCIsInVuZGVmaW5lZCIsInN0YXJ0IiwibVRpbWVTdGFydCIsIm1UaW1lRW5kIiwiX193VGltZXIiLCJ3VGltZVN0YXJ0Iiwid1RpbWVFbmQiLCJmbGFnQXN5bmNTaHV0ZG93biIsInZmc0FzeW5jSW1wbHMiLCJta2RpciIsImRpcm5hbWUiLCJzdG9yZUV4Y2VwdGlvbiIsIlNRTElURV9JT0VSUiIsInhBY2Nlc3MiLCJmbiIsImdldEZpbGVIYW5kbGUiLCJ4Q2xvc2UiLCJkZWxldGVPbkNsb3NlIiwiZGlySGFuZGxlIiwicmVtb3ZlRW50cnkiLCJmaWxlbmFtZVBhcnQiLCJTUUxJVEVfTk9URk9VTkQiLCJ4RGVsZXRlIiwieERlbGV0ZU5vV2FpdCIsInN5bmNEaXIiLCJyZWN1cnNpdmUiLCJoRGlyIiwiU1FMSVRFX0lPRVJSX0RFTEVURSIsInhGaWxlU2l6ZSIsInN6IiwiZ2V0U2l6ZSIsIk51bWJlciIsImxvY2tUeXBlIiwib2xkTG9ja1R5cGUiLCJTUUxJVEVfSU9FUlJfTE9DSyIsInhPcGVuIiwiZmxhZ3MiLCJvcGZzRmxhZ3MiLCJTUUxJVEVfT1BFTl9DUkVBVEUiLCJoRmlsZSIsImFzc2lnbiIsInNhYlZpZXciLCJzYWJGaWxlQnVmVmlldyIsIlNRTElURV9PUEVOX1JFQURPTkxZIiwiU1FMSVRFX09QRU5fREVMRVRFT05DTE9TRSIsIk9QRlNfVU5MT0NLX0FTQVAiLCJkZWZhdWx0VW5sb2NrQXNhcCIsInhSZWFkIiwib2Zmc2V0NjQiLCJuUmVhZCIsInJlYWQiLCJzdWJhcnJheSIsImF0IiwiZmlsbCIsIlNRTElURV9JT0VSUl9TSE9SVF9SRUFEIiwiU1FMSVRFX0lPRVJSX1JFQUQiLCJ4U3luYyIsImZsdXNoIiwiU1FMSVRFX0lPRVJSX0ZTWU5DIiwieFRydW5jYXRlIiwidHJ1bmNhdGUiLCJTUUxJVEVfSU9FUlJfVFJVTkNBVEUiLCJ4VW5sb2NrIiwiU1FMSVRFX0xPQ0tfTk9ORSIsIlNRTElURV9JT0VSUl9VTkxPQ0siLCJ4V3JpdGUiLCJ3cml0ZSIsIlNRTElURV9JT0VSUl9XUklURSIsIndhaXRMb29wIiwib3BIYW5kbGVycyIsImtleXMiLCJ2aSIsIm8iLCJrZXkiLCJmIiwid2hpY2hPcCIsIm9wSWQiLCJsb2FkIiwiaG5kIiwidGhlbiIsImQiLCJvbm1lc3NhZ2UiLCJkYXRhIiwib3B0IiwiSW50MzJBcnJheSIsInNhYk9QIiwiVWludDhBcnJheSIsInNhYklPIiwiZmlsZUJ1ZmZlclNpemUiLCJzYWJTMTFuVmlldyIsInNhYlMxMW5PZmZzZXQiLCJzYWJTMTFuU2l6ZSIsImZvckVhY2giLCJpc0Zpbml0ZSIsInRleHREZWNvZGVyIiwiVGV4dERlY29kZXIiLCJ0ZXh0RW5jb2RlciIsIlRleHRFbmNvZGVyIiwidmlld1U4Iiwidmlld0RWIiwiRGF0YVZpZXciLCJUeXBlSWRzIiwibnVtYmVyIiwiaWQiLCJnZXR0ZXIiLCJzZXR0ZXIiLCJiaWdpbnQiLCJib29sZWFuIiwic3RyaW5nIiwiZ2V0VHlwZUlkQnlJZCIsInRpZCIsImNsZWFyIiwiYXJnYyIsInR5cGVJZHMiLCJvZmZzZXQiLCJwdXNoIiwibGl0dGxlRW5kaWFuIiwiZ2V0SW50MzIiLCJkZWNvZGUiLCJzbGljZSIsImxlbmd0aCIsImVuY29kZSIsInNldEludDMyIiwiYnl0ZUxlbmd0aCIsInNldCIsImFzeW5jUzExbkV4Y2VwdGlvbnMiLCJwcmlvcml0eSIsImluaXRTMTFuIiwiY2F0Y2giLCJpbnN0YWxsQXN5bmNQcm94eSJdLCJzb3VyY2VSb290IjoiIn0=