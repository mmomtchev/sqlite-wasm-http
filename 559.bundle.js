(()=>{"use strict";var e,r,t={559:(e,r,t)=>{var i=t(842);const n={timeout:2e4,maxPageSize:4096,cacheSize:1024,headers:{}},o=[]||0,s=["threads","vfs","cache","http"],a={};for(const e of s)a[e]=o.includes(e)?console.debug.bind(console):()=>{};const c=function(){const e=new ArrayBuffer(2),r=new Uint8Array(e),t=new Uint16Array(e);if(r[0]=240,r[1]=13,61453==t[0])return a.threads("System is Big-Endian"),!1;if(3568==t[0])return a.threads("System is Little-Endian"),!0;throw new Error(`Failed determining endianness: ${t}`)}();var l=function(e,r,t,i){return new(t||(t=Promise))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var r;e.done?n(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(s,a)}c((i=i.apply(e,r||[])).next())}))};let d;const u={},f=new i.Z({max:32});let h,g=1;const p={xOpen:function(e){return l(this,void 0,void 0,(function*(){let r=f.get(e.url);return r instanceof Promise&&(r=yield r),void 0!==r||(r=fetch(e.url,{method:"HEAD",headers:Object.assign({},null==d?void 0:d.headers)}).then((r=>{var t;return"bytes"!==r.headers.get("Accept-Ranges")&&console.warn(`Server for ${e.url} does not advertise 'Accept-Ranges'. If the server supports it, in order to remove this message, add "Accept-Ranges: bytes". Additionally, if using CORS, add "Access-Control-Expose-Headers: *".`),{url:e.url,id:g++,size:BigInt(null!==(t=r.headers.get("Content-Length"))&&void 0!==t?t:0),pageSize:null}})),f.set(e.url,r),f.set(e.url,yield r)),0}))},xAccess:function(e,r){return l(this,void 0,void 0,(function*(){const t=new Uint32Array(r.shm,0,1);try{const i=yield p.xOpen(e,r);t[0]=0===i?1:0}catch(e){t[0]=0}return 0}))},xRead:function(e,r){var t,i,o;return l(this,void 0,void 0,(function*(){let s=f.get(e.url);if(!s)throw new Error(`File ${e.url} not open`);if(s instanceof Promise&&(s=yield s),void 0===e.n||void 0===e.offset)throw new Error("Mandatory arguments missing");if(!s.pageSize){s.pageSize=1024;const r=new ArrayBuffer(2),o=yield p.xRead({msg:"xRead",url:e.url,offset:BigInt(16),n:2},{buffer:new Uint8Array(r)}),l=new Uint16Array(r);if(0!==o)return o;if(function(e){if(c)for(let r=0;r<e.length;r++)e[r]=(65280&e[r])>>8|(255&e[r])<<8}(l),s.pageSize=l[0],a.vfs(`page size is ${s.pageSize}`),1024!=s.pageSize&&(console.warn(`Page size for ${e.url} is ${s.pageSize}, recommended size is 1024`),h.delete(s.id+"|0")),s.pageSize>(null!==(t=null==d?void 0:d.maxPageSize)&&void 0!==t?t:n.maxPageSize))throw new Error(`${s.pageSize} is over the maximum configured ${null!==(i=null==d?void 0:d.maxPageSize)&&void 0!==i?i:n.maxPageSize}`)}const l=BigInt(s.pageSize),u=BigInt(e.n),g=e.offset/l;g*l!==e.offset&&a.vfs(`Read chunk ${e.offset}:${e.n} is not page-aligned`);let m=g*l;if(m+l<e.offset+u)throw new Error(`Read chunk ${e.offset}:${e.n} spans across a page-boundary`);const v=s.id+"|"+g;let y=h.get(v);if(y instanceof Promise&&(y=yield y),"number"==typeof y){a.cache(`cache hit (multi-page segment) for ${e.url}:${g}`);const r=BigInt(y)*l;y=h.get(s.id+"|"+y),y instanceof Promise&&(y=yield y),y instanceof Uint8Array?m=r:y=void 0}if(void 0===y){a.cache(`cache miss for ${e.url}:${g}`);let r=s.pageSize,t=g>0&&h.get(s.id+"|"+(Number(g)-1));t&&(t instanceof Promise&&(t=yield t),"number"==typeof t&&(t=h.get(s.id+"|"+t)),t instanceof Promise&&(t=yield t),t instanceof Uint8Array&&(r=2*t.byteLength,a.cache(`downloading super page of size ${r}`)));const i=r/s.pageSize;a.http(`downloading page ${g} of size ${r} starting at ${m}`);const c=fetch(e.url,{method:"GET",headers:Object.assign(Object.assign({},null!==(o=null==d?void 0:d.headers)&&void 0!==o?o:n.headers),{Range:`bytes=${m}-${m+BigInt(r-1)}`})}).then((e=>e.arrayBuffer())).then((e=>new Uint8Array(e)));h.set(v,c);for(let e=Number(g)+1;e<Number(g)+i;e++)h.set(s.id+"|"+e,c.then((()=>Number(g))));if(y=yield c,!(y instanceof Uint8Array)||0===y.length)throw new Error(`Invalid HTTP response received: ${JSON.stringify(c)}`);h.set(v,y);for(let e=Number(g)+1;e<Number(g)+i;e++)h.set(s.id+"|"+e,Number(g))}else a.cache(`cache hit for ${e.url}:${g}`);const w=Number(e.offset-m);return r.buffer.set(y.subarray(w,w+e.n)),0}))},xFilesize:function(e,r){return l(this,void 0,void 0,(function*(){let t=f.get(e.url);if(!t)throw new Error(`File ${e.fid} not open`);return t instanceof Promise&&(t=yield t),new BigInt64Array(r.shm,0,1)[0]=t.size,0}))}};function m({data:e}){return l(this,void 0,void 0,(function*(){let r;a.threads("Received new work message",this,e);try{r=yield p[e.msg](e,this),a.threads("operation successful",this,r),Atomics.store(this.lock,0,r)}catch(e){console.error(e),Atomics.store(this.lock,0,1)}Atomics.notify(this.lock,0)}))}if(globalThis.onmessage=({data:e})=>{var r,t,o,s;switch(a.threads("Received new control message",e),e.msg){case"handshake":{const i=new SharedArrayBuffer((null!==(r=null==d?void 0:d.maxPageSize)&&void 0!==r?r:n.maxPageSize)+Int32Array.BYTES_PER_ELEMENT),s=new Int32Array(i,null!==(t=null==d?void 0:d.maxPageSize)&&void 0!==t?t:n.maxPageSize),a=new Uint8Array(i,0,null!==(o=null==d?void 0:d.maxPageSize)&&void 0!==o?o:n.maxPageSize);s[0]=65535,u[e.id]={id:e.id,port:e.port,shm:i,lock:s,buffer:a},postMessage({msg:"ack",id:e.id,shm:i,lock:s}),e.port.onmessage=m.bind(u[e.id])}break;case"init":d=e.options,h=new i.Z({maxSize:1024*(null!==(s=null==d?void 0:d.cacheSize)&&void 0!==s?s:n.cacheSize),sizeCalculation:e=>{var r;return null!==(r=e.byteLength)&&void 0!==r?r:4}});break;case"close":postMessage({msg:"ack"}),close();break;default:throw new Error(`Invalid message received by backend: ${e}`)}},"undefined"==typeof SharedArrayBuffer)throw new Error('SharedArrayBuffer is not available. If your browser supports it, the webserver must send "Cross-Origin-Opener-Policy: same-origin "and "Cross-Origin-Embedder-Policy: require-corp" headers.')}},i={};function n(e){var r=i[e];if(void 0!==r)return r.exports;var o=i[e]={exports:{}};return t[e](o,o.exports,n),o.exports}n.m=t,n.x=()=>{var e=n.O(void 0,[842],(()=>n(559)));return n.O(e)},e=[],n.O=(r,t,i,o)=>{if(!t){var s=1/0;for(d=0;d<e.length;d++){for(var[t,i,o]=e[d],a=!0,c=0;c<t.length;c++)(!1&o||s>=o)&&Object.keys(n.O).every((e=>n.O[e](t[c])))?t.splice(c--,1):(a=!1,o<s&&(s=o));if(a){e.splice(d--,1);var l=i();void 0!==l&&(r=l)}}return r}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[t,i,o]},n.d=(e,r)=>{for(var t in r)n.o(r,t)&&!n.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:r[t]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((r,t)=>(n.f[t](e,r),r)),[])),n.u=e=>e+".bundle.js",n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var r=n.g.document;if(!e&&r&&(r.currentScript&&(e=r.currentScript.src),!e)){var t=r.getElementsByTagName("script");t.length&&(e=t[t.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),(()=>{var e={559:1};n.f.i=(r,t)=>{e[r]||importScripts(n.p+n.u(r))};var r=self.webpackChunksqlite_wasm_http=self.webpackChunksqlite_wasm_http||[],t=r.push.bind(r);r.push=r=>{var[i,o,s]=r;for(var a in o)n.o(o,a)&&(n.m[a]=o[a]);for(s&&s(n);i.length;)e[i.pop()]=1;t(r)}})(),r=n.x,n.x=()=>n.e(842).then(r),n.x()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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ZWJwYWNrOi8vc3FsaXRlLXdhc20taHR0cC93ZWJwYWNrL3J1bnRpbWUvc3RhcnR1cCBjaHVuayBkZXBlbmRlbmNpZXMiLCJ3ZWJwYWNrOi8vc3FsaXRlLXdhc20taHR0cC8uL2Rpc3QvdmZzLWh0dHAtdHlwZXMuanMiLCJ3ZWJwYWNrOi8vc3FsaXRlLXdhc20taHR0cC8uL2Rpc3QvZW5kaWFubmVzcy5qcyIsIndlYnBhY2s6Ly9zcWxpdGUtd2FzbS1odHRwLy4vZGlzdC92ZnMtaHR0cC13b3JrZXIuanMiLCJ3ZWJwYWNrOi8vc3FsaXRlLXdhc20taHR0cC93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9zcWxpdGUtd2FzbS1odHRwL3dlYnBhY2svcnVudGltZS9kZWZpbmUgcHJvcGVydHkgZ2V0dGVycyIsIndlYnBhY2s6Ly9zcWxpdGUtd2FzbS1odHRwL3dlYnBhY2svcnVudGltZS9lbnN1cmUgY2h1bmsiLCJ3ZWJwYWNrOi8vc3FsaXRlLXdhc20taHR0cC93ZWJwYWNrL3J1bnRpbWUvZ2V0IGphdmFzY3JpcHQgY2h1bmsgZmlsZW5hbWUiLCJ3ZWJwYWNrOi8vc3FsaXRlLXdhc20taHR0cC93ZWJwYWNrL3J1bnRpbWUvZ2xvYmFsIiwid2VicGFjazovL3NxbGl0ZS13YXNtLWh0dHAvd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly9zcWxpdGUtd2FzbS1odHRwL3dlYnBhY2svcnVudGltZS9wdWJsaWNQYXRoIiwid2VicGFjazovL3NxbGl0ZS13YXNtLWh0dHAvd2VicGFjay9ydW50aW1lL2ltcG9ydFNjcmlwdHMgY2h1bmsgbG9hZGluZyIsIndlYnBhY2s6Ly9zcWxpdGUtd2FzbS1odHRwL3dlYnBhY2svc3RhcnR1cCJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgZGVmZXJyZWQgPSBbXTtcbl9fd2VicGFja19yZXF1aXJlX18uTyA9IChyZXN1bHQsIGNodW5rSWRzLCBmbiwgcHJpb3JpdHkpID0+IHtcblx0aWYoY2h1bmtJZHMpIHtcblx0XHRwcmlvcml0eSA9IHByaW9yaXR5IHx8IDA7XG5cdFx0Zm9yKHZhciBpID0gZGVmZXJyZWQubGVuZ3RoOyBpID4gMCAmJiBkZWZlcnJlZFtpIC0gMV1bMl0gPiBwcmlvcml0eTsgaS0tKSBkZWZlcnJlZFtpXSA9IGRlZmVycmVkW2kgLSAxXTtcblx0XHRkZWZlcnJlZFtpXSA9IFtjaHVua0lkcywgZm4sIHByaW9yaXR5XTtcblx0XHRyZXR1cm47XG5cdH1cblx0dmFyIG5vdEZ1bGZpbGxlZCA9IEluZmluaXR5O1xuXHRmb3IgKHZhciBpID0gMDsgaSA8IGRlZmVycmVkLmxlbmd0aDsgaSsrKSB7XG5cdFx0dmFyIFtjaHVua0lkcywgZm4sIHByaW9yaXR5XSA9IGRlZmVycmVkW2ldO1xuXHRcdHZhciBmdWxmaWxsZWQgPSB0cnVlO1xuXHRcdGZvciAodmFyIGogPSAwOyBqIDwgY2h1bmtJZHMubGVuZ3RoOyBqKyspIHtcblx0XHRcdGlmICgocHJpb3JpdHkgJiAxID09PSAwIHx8IG5vdEZ1bGZpbGxlZCA+PSBwcmlvcml0eSkgJiYgT2JqZWN0LmtleXMoX193ZWJwYWNrX3JlcXVpcmVfXy5PKS5ldmVyeSgoa2V5KSA9PiAoX193ZWJwYWNrX3JlcXVpcmVfXy5PW2tleV0oY2h1bmtJZHNbal0pKSkpIHtcblx0XHRcdFx0Y2h1bmtJZHMuc3BsaWNlKGotLSwgMSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRmdWxmaWxsZWQgPSBmYWxzZTtcblx0XHRcdFx0aWYocHJpb3JpdHkgPCBub3RGdWxmaWxsZWQpIG5vdEZ1bGZpbGxlZCA9IHByaW9yaXR5O1xuXHRcdFx0fVxuXHRcdH1cblx0XHRpZihmdWxmaWxsZWQpIHtcblx0XHRcdGRlZmVycmVkLnNwbGljZShpLS0sIDEpXG5cdFx0XHR2YXIgciA9IGZuKCk7XG5cdFx0XHRpZiAociAhPT0gdW5kZWZpbmVkKSByZXN1bHQgPSByO1xuXHRcdH1cblx0fVxuXHRyZXR1cm4gcmVzdWx0O1xufTsiLCJ2YXIgbmV4dCA9IF9fd2VicGFja19yZXF1aXJlX18ueDtcbl9fd2VicGFja19yZXF1aXJlX18ueCA9ICgpID0+IHtcblx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18uZSg4NDIpLnRoZW4obmV4dCk7XG59OyIsInZhciBfYTtcbmV4cG9ydCBjb25zdCBkZWZhdWx0T3B0aW9ucyA9IHtcbiAgICB0aW1lb3V0OiAyMDAwMCxcbiAgICBtYXhQYWdlU2l6ZTogNDA5NixcbiAgICBjYWNoZVNpemU6IDEwMjQsXG4gICAgaGVhZGVyczoge31cbn07XG5jb25zdCBkZWJ1Z09wdGlvbnMgPSAodHlwZW9mIFNRTElURV9ERUJVRyAhPT0gJ3VuZGVmaW5lZCcgJiYgU1FMSVRFX0RFQlVHKSB8fFxuICAgICh0eXBlb2YgcHJvY2VzcyAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mICgoX2EgPSBwcm9jZXNzID09PSBudWxsIHx8IHByb2Nlc3MgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHByb2Nlc3MuZW52KSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuU1FMSVRFX0RFQlVHKSAhPT0gJ3VuZGVmaW5lZCcgJiYgcHJvY2Vzcy5lbnYuU1FMSVRFX0RFQlVHKSB8fFxuICAgICcnO1xuZXhwb3J0IGNvbnN0IGRlYnVnU3lzID0gWyd0aHJlYWRzJywgJ3ZmcycsICdjYWNoZScsICdodHRwJ107XG5leHBvcnQgY29uc3QgZGVidWcgPSB7fTtcbmZvciAoY29uc3QgZCBvZiBkZWJ1Z1N5cykge1xuICAgIGRlYnVnW2RdID0gZGVidWdPcHRpb25zLmluY2x1ZGVzKGQpID9cbiAgICAgICAgY29uc29sZS5kZWJ1Zy5iaW5kKGNvbnNvbGUpIDpcbiAgICAgICAgKCkgPT4gdW5kZWZpbmVkO1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dmZzLWh0dHAtdHlwZXMuanMubWFwIiwiLy8gUHJvY2VkdXJlcyBmb3IgY2hhbmdpbmcgdGhlIGJ5dGUgc2V4XG4vLyBTUUxpdGUgaXMgYWx3YXlzIEJpZy1FbmRpYW4sIEpTIGZvbGxvd3MgdGhlIHBsYXRmb3JtLCB3aGljaCBpcyBMaXR0bGUtRW5kaWFuIG9uIHg4NlxuaW1wb3J0IHsgZGVidWcgfSBmcm9tICcuL3Zmcy1odHRwLXR5cGVzLmpzJztcbmNvbnN0IHN3YXBOZWVkZWQgPSAoZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGFiID0gbmV3IEFycmF5QnVmZmVyKDIpO1xuICAgIGNvbnN0IHU4ID0gbmV3IFVpbnQ4QXJyYXkoYWIpO1xuICAgIGNvbnN0IHUxNiA9IG5ldyBVaW50MTZBcnJheShhYik7XG4gICAgdThbMF0gPSAweEYwO1xuICAgIHU4WzFdID0gMHgwRDtcbiAgICAvLyBCaWdcbiAgICBpZiAodTE2WzBdID09IDB4RjAwRCkge1xuICAgICAgICBkZWJ1Z1sndGhyZWFkcyddKCdTeXN0ZW0gaXMgQmlnLUVuZGlhbicpO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIC8vIExpdHRsZVxuICAgIGlmICh1MTZbMF0gPT0gMHgwREYwKSB7XG4gICAgICAgIGRlYnVnWyd0aHJlYWRzJ10oJ1N5c3RlbSBpcyBMaXR0bGUtRW5kaWFuJyk7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCBkZXRlcm1pbmluZyBlbmRpYW5uZXNzOiAke3UxNn1gKTtcbn0pKCk7XG5leHBvcnQgZnVuY3Rpb24gbnRvaDE2KGRhdGEpIHtcbiAgICBpZiAoc3dhcE5lZWRlZCkge1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGRhdGFbaV0gPSAoKGRhdGFbaV0gJiAweEZGMDApID4+IDgpIHwgKChkYXRhW2ldICYgMHgwMEZGKSA8PCA4KTtcbiAgICAgICAgfVxuICAgIH1cbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWVuZGlhbm5lc3MuanMubWFwIiwiLy8gVGhpcyBpcyB0aGUgZW50cnkgcG9pbnQgZm9yIGFuIEhUVFAgYmFja2VuZCB0aHJlYWRcbi8vIEl0IGNhbiBzZXJ2ZSBtdWx0aXBsZSBTUUxpdGUgd29ya2VyIHRocmVhZHNcbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XG4gICAgfSk7XG59O1xuaW1wb3J0IExSVUNhY2hlIGZyb20gJ2xydS1jYWNoZSc7XG5pbXBvcnQgKiBhcyBWRlNIVFRQIGZyb20gJy4vdmZzLWh0dHAtdHlwZXMuanMnO1xuaW1wb3J0IHsgbnRvaDE2IH0gZnJvbSAnLi9lbmRpYW5uZXNzLmpzJztcbmltcG9ydCB7IGRlYnVnIH0gZnJvbSAnLi92ZnMtaHR0cC10eXBlcy5qcyc7XG5sZXQgb3B0aW9ucztcbi8vIFRoZSBzZXQgb2Ygc3FsaXRlIFdvcmtlcnMgdGhhdCB1c2UgdGhpcyBiYWNrZW5kXG5jb25zdCBjb25zdW1lcnMgPSB7fTtcbmNvbnN0IGZpbGVzID0gbmV3IExSVUNhY2hlKHtcbiAgICBtYXg6IDMyXG59KTtcbi8vIFRoZSBlbnRyeSBmb3IgYSBnaXZlbiBwYWdlIGNhbiBiZSBlaXRoZXIgdGhlIHBhZ2UgaXRzZWxmXG4vLyBvciB0aGUgbnVtYmVyIG9mIHRoZSBwYWdlIHRoYXQgaGFzIHRoZSBwYXJlbnQgc3VwZXItcGFnZVxuLy8gSGVyZSBpcyBhbiBleGFtcGxlIG9mIGEgY2FjaGUgc3RydWN0dXJlIChpbmRleGVkIGJ5IHRoZSBVUkwgKyBwYWdlIG51bWJlcilcbi8vIFVSTHwwIC0+IFVpbnQ4QXJyYXkocGFnZSkgICAgICAgICAgICAgICAgICAgICAjIFRoaXMgcGFnZSBpcyBpbiBjYWNoZVxuLy8gVVJMfDEgLT4gdW5kZWZpbmVkICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgVGhlc2UgdHdvXG4vLyBVUkx8MiAtPiB1bmRlZmluZWQgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBhcmUgbm90XG4vLyBVUkx8MyAtPiBQcm9taXNlPFVpbnQ4QXJyYXkocGFnZSAqIDIpPiAgICAgICAgIyBUaGlzIGlzIGEgY3VycmVudGx5IGRvd25sb2FkaW5nIDItcGFnZSBzZWdtZW50XG4vLyBVUkx8NCAtPiBQcm9taXNlPDM+ICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBUaGlzIHJlZmVyZW5jZXMgdGhlIHByZXZpb3VzIG9uZVxuLy8gVVJMfDUgLT4gMiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgQW4gaW52YWxpZCBzdGFsZSBlbnRyeSB0aGF0IHdpbGwgYmUgb3ZlcndyaXR0ZW5cbmxldCBjYWNoZTtcbmxldCBuZXh0SWQgPSAxO1xuY29uc3QgYmFja2VuZEFzeW5jTWV0aG9kcyA9IHtcbiAgICAvLyBIVFRQIGlzIGEgc3RhdGVsZXNzIHByb3RvY29sLCBzbyB4T3BlbiBtZWFucyB2ZXJpZnkgaWYgdGhlIFVSTCBpcyB2YWxpZFxuICAgIHhPcGVuOiBmdW5jdGlvbiAobXNnKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBsZXQgZW50cnkgPSBmaWxlcy5nZXQobXNnLnVybCk7XG4gICAgICAgICAgICBpZiAoZW50cnkgaW5zdGFuY2VvZiBQcm9taXNlKVxuICAgICAgICAgICAgICAgIGVudHJ5ID0geWllbGQgZW50cnk7XG4gICAgICAgICAgICBpZiAoZW50cnkgIT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIC8vIFNldCBhIHByb21pc2UgZm9yIHRoZSBuZXh0IG9wZW5lciBvZiB0aGUgc2FtZSBmaWxlIHRvIGF3YWl0IHVwb25cbiAgICAgICAgICAgIGVudHJ5ID0gZmV0Y2gobXNnLnVybCwgeyBtZXRob2Q6ICdIRUFEJywgaGVhZGVyczogT2JqZWN0LmFzc2lnbih7fSwgb3B0aW9ucyA9PT0gbnVsbCB8fCBvcHRpb25zID09PSB2b2lkIDAgPyB2b2lkIDAgOiBvcHRpb25zLmhlYWRlcnMpIH0pXG4gICAgICAgICAgICAgICAgLnRoZW4oKGhlYWQpID0+IHtcbiAgICAgICAgICAgICAgICB2YXIgX2E7XG4gICAgICAgICAgICAgICAgaWYgKGhlYWQuaGVhZGVycy5nZXQoJ0FjY2VwdC1SYW5nZXMnKSAhPT0gJ2J5dGVzJykge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYFNlcnZlciBmb3IgJHttc2cudXJsfSBkb2VzIG5vdCBhZHZlcnRpc2UgJ0FjY2VwdC1SYW5nZXMnLiBgICtcbiAgICAgICAgICAgICAgICAgICAgICAgICdJZiB0aGUgc2VydmVyIHN1cHBvcnRzIGl0LCBpbiBvcmRlciB0byByZW1vdmUgdGhpcyBtZXNzYWdlLCBhZGQgXCJBY2NlcHQtUmFuZ2VzOiBieXRlc1wiLiAnICtcbiAgICAgICAgICAgICAgICAgICAgICAgICdBZGRpdGlvbmFsbHksIGlmIHVzaW5nIENPUlMsIGFkZCBcIkFjY2Vzcy1Db250cm9sLUV4cG9zZS1IZWFkZXJzOiAqXCIuJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHVybDogbXNnLnVybCxcbiAgICAgICAgICAgICAgICAgICAgaWQ6IG5leHRJZCsrLFxuICAgICAgICAgICAgICAgICAgICBzaXplOiBCaWdJbnQoKF9hID0gaGVhZC5oZWFkZXJzLmdldCgnQ29udGVudC1MZW5ndGgnKSkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogMCksXG4gICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgd2lsbCBiZSBkZXRlcm1pbmVkIG9uIHRoZSBmaXJzdCByZWFkXG4gICAgICAgICAgICAgICAgICAgIHBhZ2VTaXplOiBudWxsXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgZmlsZXMuc2V0KG1zZy51cmwsIGVudHJ5KTtcbiAgICAgICAgICAgIC8vIFJlcGxhY2UgaXQgd2l0aCB0aGUgYWN0dWFsIGVudHJ5IG9uY2UgcmVzb2x2ZWRcbiAgICAgICAgICAgIGZpbGVzLnNldChtc2cudXJsLCB5aWVsZCBlbnRyeSk7XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfSk7XG4gICAgfSxcbiAgICAvLyBUaGVyZSBpcyBubyByZWFsIGRpZmZlcmVuY2UgYmV0d2VlbiB4T3BlbiBhbmQgeEFjY2Vzcywgb25seSB0aGUgc2VtYW50aWNzIGRpZmZlclxuICAgIHhBY2Nlc3M6IGZ1bmN0aW9uIChtc2csIGNvbnN1bWVyKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBuZXcgVWludDMyQXJyYXkoY29uc3VtZXIuc2htLCAwLCAxKTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3QgciA9IHlpZWxkIGJhY2tlbmRBc3luY01ldGhvZHMueE9wZW4obXNnLCBjb25zdW1lcik7XG4gICAgICAgICAgICAgICAgaWYgKHIgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0WzBdID0gMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdFswXSA9IDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKF9hKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0WzBdID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9KTtcbiAgICB9LFxuICAgIHhSZWFkOiBmdW5jdGlvbiAobXNnLCBjb25zdW1lcikge1xuICAgICAgICB2YXIgX2EsIF9iLCBfYztcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGxldCBlbnRyeSA9IGZpbGVzLmdldChtc2cudXJsKTtcbiAgICAgICAgICAgIGlmICghZW50cnkpXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGaWxlICR7bXNnLnVybH0gbm90IG9wZW5gKTtcbiAgICAgICAgICAgIGlmIChlbnRyeSBpbnN0YW5jZW9mIFByb21pc2UpXG4gICAgICAgICAgICAgICAgZW50cnkgPSB5aWVsZCBlbnRyeTtcbiAgICAgICAgICAgIGlmIChtc2cubiA9PT0gdW5kZWZpbmVkIHx8IG1zZy5vZmZzZXQgPT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01hbmRhdG9yeSBhcmd1bWVudHMgbWlzc2luZycpO1xuICAgICAgICAgICAgaWYgKCFlbnRyeS5wYWdlU2l6ZSkge1xuICAgICAgICAgICAgICAgIC8vIERldGVybWluZSB0aGUgcGFnZSBzaXplIGlmIHdlIGRvbid0IGtub3cgaXRcbiAgICAgICAgICAgICAgICAvLyBJdCBpcyBpbiB0d28gYmlnLWVuZGlhbiBieXRlcyBhdCBvZmZzZXQgMTYgaW4gd2hhdCBpcyBhbHdheXMgdGhlIGZpcnN0IHBhZ2VcbiAgICAgICAgICAgICAgICBlbnRyeS5wYWdlU2l6ZSA9IDEwMjQ7XG4gICAgICAgICAgICAgICAgY29uc3QgcGFnZURhdGFCdWZmZXIgPSBuZXcgQXJyYXlCdWZmZXIoMik7XG4gICAgICAgICAgICAgICAgY29uc3QgciA9IHlpZWxkIGJhY2tlbmRBc3luY01ldGhvZHMueFJlYWQoeyBtc2c6ICd4UmVhZCcsIHVybDogbXNnLnVybCwgb2Zmc2V0OiBCaWdJbnQoMTYpLCBuOiAyIH0sIHsgYnVmZmVyOiBuZXcgVWludDhBcnJheShwYWdlRGF0YUJ1ZmZlcikgfSk7XG4gICAgICAgICAgICAgICAgY29uc3QgcGFnZURhdGEgPSBuZXcgVWludDE2QXJyYXkocGFnZURhdGFCdWZmZXIpO1xuICAgICAgICAgICAgICAgIGlmIChyICE9PSAwKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcjtcbiAgICAgICAgICAgICAgICBudG9oMTYocGFnZURhdGEpO1xuICAgICAgICAgICAgICAgIGVudHJ5LnBhZ2VTaXplID0gcGFnZURhdGFbMF07XG4gICAgICAgICAgICAgICAgZGVidWdbJ3ZmcyddKGBwYWdlIHNpemUgaXMgJHtlbnRyeS5wYWdlU2l6ZX1gKTtcbiAgICAgICAgICAgICAgICBpZiAoZW50cnkucGFnZVNpemUgIT0gMTAyNCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGUgcGFnZSBzaXplIGlzIG5vdCAxMDI0IHdlIGNhbid0IGtlZXAgdGhpcyBcInBhZ2VcIiBpbiB0aGUgY2FjaGVcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBQYWdlIHNpemUgZm9yICR7bXNnLnVybH0gaXMgJHtlbnRyeS5wYWdlU2l6ZX0sIHJlY29tbWVuZGVkIHNpemUgaXMgMTAyNGApO1xuICAgICAgICAgICAgICAgICAgICBjYWNoZS5kZWxldGUoZW50cnkuaWQgKyAnfDAnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGVudHJ5LnBhZ2VTaXplID4gKChfYSA9IG9wdGlvbnMgPT09IG51bGwgfHwgb3B0aW9ucyA9PT0gdm9pZCAwID8gdm9pZCAwIDogb3B0aW9ucy5tYXhQYWdlU2l6ZSkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogVkZTSFRUUC5kZWZhdWx0T3B0aW9ucy5tYXhQYWdlU2l6ZSkpXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgJHtlbnRyeS5wYWdlU2l6ZX0gaXMgb3ZlciB0aGUgbWF4aW11bSBjb25maWd1cmVkIGAgK1xuICAgICAgICAgICAgICAgICAgICAgICAgYCR7KF9iID0gb3B0aW9ucyA9PT0gbnVsbCB8fCBvcHRpb25zID09PSB2b2lkIDAgPyB2b2lkIDAgOiBvcHRpb25zLm1heFBhZ2VTaXplKSAhPT0gbnVsbCAmJiBfYiAhPT0gdm9pZCAwID8gX2IgOiBWRlNIVFRQLmRlZmF1bHRPcHRpb25zLm1heFBhZ2VTaXplfWApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgcGFnZVNpemUgPSBCaWdJbnQoZW50cnkucGFnZVNpemUpO1xuICAgICAgICAgICAgY29uc3QgbGVuID0gQmlnSW50KG1zZy5uKTtcbiAgICAgICAgICAgIGNvbnN0IHBhZ2UgPSBtc2cub2Zmc2V0IC8gcGFnZVNpemU7XG4gICAgICAgICAgICBpZiAocGFnZSAqIHBhZ2VTaXplICE9PSBtc2cub2Zmc2V0KVxuICAgICAgICAgICAgICAgIGRlYnVnWyd2ZnMnXShgUmVhZCBjaHVuayAke21zZy5vZmZzZXR9OiR7bXNnLm59IGlzIG5vdCBwYWdlLWFsaWduZWRgKTtcbiAgICAgICAgICAgIGxldCBwYWdlU3RhcnQgPSBwYWdlICogcGFnZVNpemU7XG4gICAgICAgICAgICBpZiAocGFnZVN0YXJ0ICsgcGFnZVNpemUgPCBtc2cub2Zmc2V0ICsgbGVuKVxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgUmVhZCBjaHVuayAke21zZy5vZmZzZXR9OiR7bXNnLm59IHNwYW5zIGFjcm9zcyBhIHBhZ2UtYm91bmRhcnlgKTtcbiAgICAgICAgICAgIGNvbnN0IGNhY2hlSWQgPSBlbnRyeS5pZCArICd8JyArIHBhZ2U7XG4gICAgICAgICAgICBsZXQgZGF0YSA9IGNhY2hlLmdldChjYWNoZUlkKTtcbiAgICAgICAgICAgIGlmIChkYXRhIGluc3RhbmNlb2YgUHJvbWlzZSlcbiAgICAgICAgICAgICAgICAvLyBUaGlzIG1lYW5zIHRoYXQgYW5vdGhlciB0aHJlYWQgaGFzIHJlcXVlc3RlZCB0aGlzIHNlZ21lbnRcbiAgICAgICAgICAgICAgICBkYXRhID0geWllbGQgZGF0YTtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgZGF0YSA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgICAgICBkZWJ1Z1snY2FjaGUnXShgY2FjaGUgaGl0IChtdWx0aS1wYWdlIHNlZ21lbnQpIGZvciAke21zZy51cmx9OiR7cGFnZX1gKTtcbiAgICAgICAgICAgICAgICAvLyBUaGlzIHBhZ2UgaXMgcHJlc2VudCBhcyBhIHNlZ21lbnQgb2YgYSBzdXBlci1wYWdlXG4gICAgICAgICAgICAgICAgY29uc3QgbmV3UGFnZVN0YXJ0ID0gQmlnSW50KGRhdGEpICogcGFnZVNpemU7XG4gICAgICAgICAgICAgICAgZGF0YSA9IGNhY2hlLmdldChlbnRyeS5pZCArICd8JyArIGRhdGEpO1xuICAgICAgICAgICAgICAgIGlmIChkYXRhIGluc3RhbmNlb2YgUHJvbWlzZSlcbiAgICAgICAgICAgICAgICAgICAgZGF0YSA9IHlpZWxkIGRhdGE7XG4gICAgICAgICAgICAgICAgaWYgKGRhdGEgaW5zdGFuY2VvZiBVaW50OEFycmF5KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIE5vdCBhbGwgc3VicGFnZXMgYXJlIHZhbGlkLCB0aGVyZSBhcmUgdHdvIHBvc3NpYmxlIGNhc2VzXG4gICAgICAgICAgICAgICAgICAgIC8vIHdoZXJlIGEgbm9uLXZhbGlkIHN1cGVycGFnZSBjYW4gYmUgcmVmZXJlbmNlZDpcbiAgICAgICAgICAgICAgICAgICAgLy8gKiB0aGUgc3VwZXJwYWdlIHdhcyB0b28gYmlnIHRvIGZpdCBpbiB0aGUgY2FjaGVcbiAgICAgICAgICAgICAgICAgICAgLy8gKiB0aGUgc3VwZXJwYWdlIHdhcyBldmljdGVkIGJlZm9yZSB0aGUgc3Vic2VnbWVudHNcbiAgICAgICAgICAgICAgICAgICAgcGFnZVN0YXJ0ID0gbmV3UGFnZVN0YXJ0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZGF0YSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodHlwZW9mIGRhdGEgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgZGVidWdbJ2NhY2hlJ10oYGNhY2hlIG1pc3MgZm9yICR7bXNnLnVybH06JHtwYWdlfWApO1xuICAgICAgICAgICAgICAgIGxldCBjaHVua1NpemUgPSBlbnRyeS5wYWdlU2l6ZTtcbiAgICAgICAgICAgICAgICAvLyBJZiB0aGUgcHJldmlvdXMgcGFnZSBpcyBpbiB0aGUgY2FjaGUsIHdlIGRvdWJsZSB0aGUgcGFnZSBzaXplXG4gICAgICAgICAgICAgICAgLy8gVGhpcyB3YXMgdGhlIG9yaWdpbmFsIHBhZ2UgbWVyZ2luZyBhbGdvcml0aG0gaW1wbGVtZW50ZWQgYnkgQHBoaXJlc2t5XG4gICAgICAgICAgICAgICAgbGV0IHByZXYgPSBwYWdlID4gMCAmJiBjYWNoZS5nZXQoZW50cnkuaWQgKyAnfCcgKyAoTnVtYmVyKHBhZ2UpIC0gMSkpO1xuICAgICAgICAgICAgICAgIGlmIChwcmV2KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwcmV2IGluc3RhbmNlb2YgUHJvbWlzZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZXYgPSB5aWVsZCBwcmV2O1xuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHByZXYgPT09ICdudW1iZXInKVxuICAgICAgICAgICAgICAgICAgICAgICAgcHJldiA9IGNhY2hlLmdldChlbnRyeS5pZCArICd8JyArIHByZXYpO1xuICAgICAgICAgICAgICAgICAgICBpZiAocHJldiBpbnN0YW5jZW9mIFByb21pc2UpXG4gICAgICAgICAgICAgICAgICAgICAgICBwcmV2ID0geWllbGQgcHJldjtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHByZXYgaW5zdGFuY2VvZiBVaW50OEFycmF5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBWYWxpZCBzdXBlcnBhZ2VcbiAgICAgICAgICAgICAgICAgICAgICAgIGNodW5rU2l6ZSA9IHByZXYuYnl0ZUxlbmd0aCAqIDI7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWJ1Z1snY2FjaGUnXShgZG93bmxvYWRpbmcgc3VwZXIgcGFnZSBvZiBzaXplICR7Y2h1bmtTaXplfWApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IHBhZ2VzID0gY2h1bmtTaXplIC8gZW50cnkucGFnZVNpemU7XG4gICAgICAgICAgICAgICAgLy8gRG93bmxvYWQgYSBuZXcgc2VnbWVudFxuICAgICAgICAgICAgICAgIGRlYnVnWydodHRwJ10oYGRvd25sb2FkaW5nIHBhZ2UgJHtwYWdlfSBvZiBzaXplICR7Y2h1bmtTaXplfSBzdGFydGluZyBhdCAke3BhZ2VTdGFydH1gKTtcbiAgICAgICAgICAgICAgICBjb25zdCByZXNwID0gZmV0Y2gobXNnLnVybCwge1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sICgoX2MgPSBvcHRpb25zID09PSBudWxsIHx8IG9wdGlvbnMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IG9wdGlvbnMuaGVhZGVycykgIT09IG51bGwgJiYgX2MgIT09IHZvaWQgMCA/IF9jIDogVkZTSFRUUC5kZWZhdWx0T3B0aW9ucy5oZWFkZXJzKSksIHsgJ1JhbmdlJzogYGJ5dGVzPSR7cGFnZVN0YXJ0fS0ke3BhZ2VTdGFydCArIEJpZ0ludChjaHVua1NpemUgLSAxKX1gIH0pXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oKHIpID0+IHIuYXJyYXlCdWZmZXIoKSlcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oKHIpID0+IG5ldyBVaW50OEFycmF5KHIpKTtcbiAgICAgICAgICAgICAgICAvLyBXZSBzeW5jaHJvbm91c2x5IHNldCBhIFByb21pc2UgaW4gdGhlIGNhY2hlIGluIGNhc2UgYW5vdGhlciB0aHJlYWRcbiAgICAgICAgICAgICAgICAvLyB0cmllcyB0byByZWFkIHRoZSBzYW1lIHNlZ21lbnRcbiAgICAgICAgICAgICAgICBjYWNoZS5zZXQoY2FjaGVJZCwgcmVzcCk7XG4gICAgICAgICAgICAgICAgLy8gVGhlc2UgcG9pbnQgdG8gdGhlIHBhcmVudCBzdXBlci1wYWdlIGFuZCByZXNvbHZlIGF0IHRoZSBzYW1lIHRpbWUgYXMgcmVzcFxuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSBOdW1iZXIocGFnZSkgKyAxOyBpIDwgTnVtYmVyKHBhZ2UpICsgcGFnZXM7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBjYWNoZS5zZXQoZW50cnkuaWQgKyAnfCcgKyBpLCByZXNwLnRoZW4oKCkgPT4gTnVtYmVyKHBhZ2UpKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGRhdGEgPSB5aWVsZCByZXNwO1xuICAgICAgICAgICAgICAgIGlmICghKGRhdGEgaW5zdGFuY2VvZiBVaW50OEFycmF5KSB8fCBkYXRhLmxlbmd0aCA9PT0gMClcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIEhUVFAgcmVzcG9uc2UgcmVjZWl2ZWQ6ICR7SlNPTi5zdHJpbmdpZnkocmVzcCl9YCk7XG4gICAgICAgICAgICAgICAgLy8gSW4gY2FzZSBvZiBhIG11bHRpcGxlLXBhZ2Ugc2VnbWVudCwgdGhpcyBpcyB0aGUgcGFyZW50IHN1cGVyLXBhZ2VcbiAgICAgICAgICAgICAgICBjYWNoZS5zZXQoY2FjaGVJZCwgZGF0YSk7XG4gICAgICAgICAgICAgICAgLy8gVGhlc2UgcG9pbnQgdG8gdGhlIHBhcmVudCBzdXBlci1wYWdlXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IE51bWJlcihwYWdlKSArIDE7IGkgPCBOdW1iZXIocGFnZSkgKyBwYWdlczsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhY2hlLnNldChlbnRyeS5pZCArICd8JyArIGksIE51bWJlcihwYWdlKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgZGVidWdbJ2NhY2hlJ10oYGNhY2hlIGhpdCBmb3IgJHttc2cudXJsfToke3BhZ2V9YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBwYWdlT2Zmc2V0ID0gTnVtYmVyKG1zZy5vZmZzZXQgLSBwYWdlU3RhcnQpO1xuICAgICAgICAgICAgY29uc3VtZXIuYnVmZmVyLnNldChkYXRhLnN1YmFycmF5KHBhZ2VPZmZzZXQsIHBhZ2VPZmZzZXQgKyBtc2cubikpO1xuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH0pO1xuICAgIH0sXG4gICAgLy8gVGhpcyBpcyBjYWNoZWRcbiAgICB4RmlsZXNpemU6IGZ1bmN0aW9uIChtc2csIGNvbnN1bWVyKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBsZXQgZW50cnkgPSBmaWxlcy5nZXQobXNnLnVybCk7XG4gICAgICAgICAgICBpZiAoIWVudHJ5KVxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgRmlsZSAke21zZy5maWR9IG5vdCBvcGVuYCk7XG4gICAgICAgICAgICBpZiAoZW50cnkgaW5zdGFuY2VvZiBQcm9taXNlKVxuICAgICAgICAgICAgICAgIGVudHJ5ID0geWllbGQgZW50cnk7XG4gICAgICAgICAgICBjb25zdCBvdXQgPSBuZXcgQmlnSW50NjRBcnJheShjb25zdW1lci5zaG0sIDAsIDEpO1xuICAgICAgICAgICAgb3V0WzBdID0gZW50cnkuc2l6ZTtcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9KTtcbiAgICB9XG59O1xuZnVuY3Rpb24gd29ya01lc3NhZ2UoeyBkYXRhIH0pIHtcbiAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICBkZWJ1Z1sndGhyZWFkcyddKCdSZWNlaXZlZCBuZXcgd29yayBtZXNzYWdlJywgdGhpcywgZGF0YSk7XG4gICAgICAgIGxldCByO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgciA9IHlpZWxkIGJhY2tlbmRBc3luY01ldGhvZHNbZGF0YS5tc2ddKGRhdGEsIHRoaXMpO1xuICAgICAgICAgICAgZGVidWdbJ3RocmVhZHMnXSgnb3BlcmF0aW9uIHN1Y2Nlc3NmdWwnLCB0aGlzLCByKTtcbiAgICAgICAgICAgIEF0b21pY3Muc3RvcmUodGhpcy5sb2NrLCAwLCByKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihlKTtcbiAgICAgICAgICAgIEF0b21pY3Muc3RvcmUodGhpcy5sb2NrLCAwLCAxKTtcbiAgICAgICAgfVxuICAgICAgICBBdG9taWNzLm5vdGlmeSh0aGlzLmxvY2ssIDApO1xuICAgIH0pO1xufVxuZ2xvYmFsVGhpcy5vbm1lc3NhZ2UgPSAoeyBkYXRhIH0pID0+IHtcbiAgICB2YXIgX2EsIF9iLCBfYywgX2Q7XG4gICAgZGVidWdbJ3RocmVhZHMnXSgnUmVjZWl2ZWQgbmV3IGNvbnRyb2wgbWVzc2FnZScsIGRhdGEpO1xuICAgIHN3aXRjaCAoZGF0YS5tc2cpIHtcbiAgICAgICAgY2FzZSAnaGFuZHNoYWtlJzpcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjb25zdCBzaG0gPSBuZXcgU2hhcmVkQXJyYXlCdWZmZXIoKChfYSA9IG9wdGlvbnMgPT09IG51bGwgfHwgb3B0aW9ucyA9PT0gdm9pZCAwID8gdm9pZCAwIDogb3B0aW9ucy5tYXhQYWdlU2l6ZSkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogVkZTSFRUUC5kZWZhdWx0T3B0aW9ucy5tYXhQYWdlU2l6ZSlcbiAgICAgICAgICAgICAgICAgICAgKyBJbnQzMkFycmF5LkJZVEVTX1BFUl9FTEVNRU5UKTtcbiAgICAgICAgICAgICAgICBjb25zdCBsb2NrID0gbmV3IEludDMyQXJyYXkoc2htLCAoKF9iID0gb3B0aW9ucyA9PT0gbnVsbCB8fCBvcHRpb25zID09PSB2b2lkIDAgPyB2b2lkIDAgOiBvcHRpb25zLm1heFBhZ2VTaXplKSAhPT0gbnVsbCAmJiBfYiAhPT0gdm9pZCAwID8gX2IgOiBWRlNIVFRQLmRlZmF1bHRPcHRpb25zLm1heFBhZ2VTaXplKSk7XG4gICAgICAgICAgICAgICAgY29uc3QgYnVmZmVyID0gbmV3IFVpbnQ4QXJyYXkoc2htLCAwLCAoKF9jID0gb3B0aW9ucyA9PT0gbnVsbCB8fCBvcHRpb25zID09PSB2b2lkIDAgPyB2b2lkIDAgOiBvcHRpb25zLm1heFBhZ2VTaXplKSAhPT0gbnVsbCAmJiBfYyAhPT0gdm9pZCAwID8gX2MgOiBWRlNIVFRQLmRlZmF1bHRPcHRpb25zLm1heFBhZ2VTaXplKSk7XG4gICAgICAgICAgICAgICAgbG9ja1swXSA9IDB4ZmZmZjtcbiAgICAgICAgICAgICAgICBjb25zdW1lcnNbZGF0YS5pZF0gPSB7IGlkOiBkYXRhLmlkLCBwb3J0OiBkYXRhLnBvcnQsIHNobSwgbG9jaywgYnVmZmVyIH07XG4gICAgICAgICAgICAgICAgcG9zdE1lc3NhZ2UoeyBtc2c6ICdhY2snLCBpZDogZGF0YS5pZCwgc2htLCBsb2NrIH0pO1xuICAgICAgICAgICAgICAgIGRhdGEucG9ydC5vbm1lc3NhZ2UgPSB3b3JrTWVzc2FnZS5iaW5kKGNvbnN1bWVyc1tkYXRhLmlkXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnaW5pdCc6XG4gICAgICAgICAgICBvcHRpb25zID0gZGF0YS5vcHRpb25zO1xuICAgICAgICAgICAgY2FjaGUgPSBuZXcgTFJVQ2FjaGUoe1xuICAgICAgICAgICAgICAgIG1heFNpemU6ICgoX2QgPSBvcHRpb25zID09PSBudWxsIHx8IG9wdGlvbnMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IG9wdGlvbnMuY2FjaGVTaXplKSAhPT0gbnVsbCAmJiBfZCAhPT0gdm9pZCAwID8gX2QgOiBWRlNIVFRQLmRlZmF1bHRPcHRpb25zLmNhY2hlU2l6ZSkgKiAxMDI0LFxuICAgICAgICAgICAgICAgIHNpemVDYWxjdWxhdGlvbjogKHZhbHVlKSA9PiB7IHZhciBfYTsgcmV0dXJuIChfYSA9IHZhbHVlLmJ5dGVMZW5ndGgpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IDQ7IH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ2Nsb3NlJzpcbiAgICAgICAgICAgIHBvc3RNZXNzYWdlKHsgbXNnOiAnYWNrJyB9KTtcbiAgICAgICAgICAgIGNsb3NlKCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCBtZXNzYWdlIHJlY2VpdmVkIGJ5IGJhY2tlbmQ6ICR7ZGF0YX1gKTtcbiAgICB9XG59O1xuaWYgKHR5cGVvZiBTaGFyZWRBcnJheUJ1ZmZlciA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1NoYXJlZEFycmF5QnVmZmVyIGlzIG5vdCBhdmFpbGFibGUuICcgK1xuICAgICAgICAnSWYgeW91ciBicm93c2VyIHN1cHBvcnRzIGl0LCB0aGUgd2Vic2VydmVyIG11c3Qgc2VuZCAnICtcbiAgICAgICAgJ1wiQ3Jvc3MtT3JpZ2luLU9wZW5lci1Qb2xpY3k6IHNhbWUtb3JpZ2luIFwiJyArXG4gICAgICAgICdhbmQgXCJDcm9zcy1PcmlnaW4tRW1iZWRkZXItUG9saWN5OiByZXF1aXJlLWNvcnBcIiBoZWFkZXJzLicpO1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dmZzLWh0dHAtd29ya2VyLmpzLm1hcCIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0obW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4vLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuX193ZWJwYWNrX3JlcXVpcmVfXy5tID0gX193ZWJwYWNrX21vZHVsZXNfXztcblxuLy8gdGhlIHN0YXJ0dXAgZnVuY3Rpb25cbl9fd2VicGFja19yZXF1aXJlX18ueCA9ICgpID0+IHtcblx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG5cdC8vIFRoaXMgZW50cnkgbW9kdWxlIGRlcGVuZHMgb24gb3RoZXIgbG9hZGVkIGNodW5rcyBhbmQgZXhlY3V0aW9uIG5lZWQgdG8gYmUgZGVsYXllZFxuXHR2YXIgX193ZWJwYWNrX2V4cG9ydHNfXyA9IF9fd2VicGFja19yZXF1aXJlX18uTyh1bmRlZmluZWQsIFs4NDJdLCAoKSA9PiAoX193ZWJwYWNrX3JlcXVpcmVfXyg1NTkpKSlcblx0X193ZWJwYWNrX2V4cG9ydHNfXyA9IF9fd2VicGFja19yZXF1aXJlX18uTyhfX3dlYnBhY2tfZXhwb3J0c19fKTtcblx0cmV0dXJuIF9fd2VicGFja19leHBvcnRzX187XG59O1xuXG4iLCIvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9ucyBmb3IgaGFybW9ueSBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSAoZXhwb3J0cywgZGVmaW5pdGlvbikgPT4ge1xuXHRmb3IodmFyIGtleSBpbiBkZWZpbml0aW9uKSB7XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGRlZmluaXRpb24sIGtleSkgJiYgIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBrZXkpKSB7XG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZGVmaW5pdGlvbltrZXldIH0pO1xuXHRcdH1cblx0fVxufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLmYgPSB7fTtcbi8vIFRoaXMgZmlsZSBjb250YWlucyBvbmx5IHRoZSBlbnRyeSBjaHVuay5cbi8vIFRoZSBjaHVuayBsb2FkaW5nIGZ1bmN0aW9uIGZvciBhZGRpdGlvbmFsIGNodW5rc1xuX193ZWJwYWNrX3JlcXVpcmVfXy5lID0gKGNodW5rSWQpID0+IHtcblx0cmV0dXJuIFByb21pc2UuYWxsKE9iamVjdC5rZXlzKF9fd2VicGFja19yZXF1aXJlX18uZikucmVkdWNlKChwcm9taXNlcywga2V5KSA9PiB7XG5cdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5mW2tleV0oY2h1bmtJZCwgcHJvbWlzZXMpO1xuXHRcdHJldHVybiBwcm9taXNlcztcblx0fSwgW10pKTtcbn07IiwiLy8gVGhpcyBmdW5jdGlvbiBhbGxvdyB0byByZWZlcmVuY2UgYXN5bmMgY2h1bmtzIGFuZCBzaWJsaW5nIGNodW5rcyBmb3IgdGhlIGVudHJ5cG9pbnRcbl9fd2VicGFja19yZXF1aXJlX18udSA9IChjaHVua0lkKSA9PiB7XG5cdC8vIHJldHVybiB1cmwgZm9yIGZpbGVuYW1lcyBiYXNlZCBvbiB0ZW1wbGF0ZVxuXHRyZXR1cm4gXCJcIiArIGNodW5rSWQgKyBcIi5idW5kbGUuanNcIjtcbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5nID0gKGZ1bmN0aW9uKCkge1xuXHRpZiAodHlwZW9mIGdsb2JhbFRoaXMgPT09ICdvYmplY3QnKSByZXR1cm4gZ2xvYmFsVGhpcztcblx0dHJ5IHtcblx0XHRyZXR1cm4gdGhpcyB8fCBuZXcgRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKTtcblx0fSBjYXRjaCAoZSkge1xuXHRcdGlmICh0eXBlb2Ygd2luZG93ID09PSAnb2JqZWN0JykgcmV0dXJuIHdpbmRvdztcblx0fVxufSkoKTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSAob2JqLCBwcm9wKSA9PiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCkpIiwidmFyIHNjcmlwdFVybDtcbmlmIChfX3dlYnBhY2tfcmVxdWlyZV9fLmcuaW1wb3J0U2NyaXB0cykgc2NyaXB0VXJsID0gX193ZWJwYWNrX3JlcXVpcmVfXy5nLmxvY2F0aW9uICsgXCJcIjtcbnZhciBkb2N1bWVudCA9IF9fd2VicGFja19yZXF1aXJlX18uZy5kb2N1bWVudDtcbmlmICghc2NyaXB0VXJsICYmIGRvY3VtZW50KSB7XG5cdGlmIChkb2N1bWVudC5jdXJyZW50U2NyaXB0KVxuXHRcdHNjcmlwdFVybCA9IGRvY3VtZW50LmN1cnJlbnRTY3JpcHQuc3JjO1xuXHRpZiAoIXNjcmlwdFVybCkge1xuXHRcdHZhciBzY3JpcHRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJzY3JpcHRcIik7XG5cdFx0aWYoc2NyaXB0cy5sZW5ndGgpIHNjcmlwdFVybCA9IHNjcmlwdHNbc2NyaXB0cy5sZW5ndGggLSAxXS5zcmNcblx0fVxufVxuLy8gV2hlbiBzdXBwb3J0aW5nIGJyb3dzZXJzIHdoZXJlIGFuIGF1dG9tYXRpYyBwdWJsaWNQYXRoIGlzIG5vdCBzdXBwb3J0ZWQgeW91IG11c3Qgc3BlY2lmeSBhbiBvdXRwdXQucHVibGljUGF0aCBtYW51YWxseSB2aWEgY29uZmlndXJhdGlvblxuLy8gb3IgcGFzcyBhbiBlbXB0eSBzdHJpbmcgKFwiXCIpIGFuZCBzZXQgdGhlIF9fd2VicGFja19wdWJsaWNfcGF0aF9fIHZhcmlhYmxlIGZyb20geW91ciBjb2RlIHRvIHVzZSB5b3VyIG93biBsb2dpYy5cbmlmICghc2NyaXB0VXJsKSB0aHJvdyBuZXcgRXJyb3IoXCJBdXRvbWF0aWMgcHVibGljUGF0aCBpcyBub3Qgc3VwcG9ydGVkIGluIHRoaXMgYnJvd3NlclwiKTtcbnNjcmlwdFVybCA9IHNjcmlwdFVybC5yZXBsYWNlKC8jLiokLywgXCJcIikucmVwbGFjZSgvXFw/LiokLywgXCJcIikucmVwbGFjZSgvXFwvW15cXC9dKyQvLCBcIi9cIik7XG5fX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBzY3JpcHRVcmw7IiwiLy8gbm8gYmFzZVVSSVxuXG4vLyBvYmplY3QgdG8gc3RvcmUgbG9hZGVkIGNodW5rc1xuLy8gXCIxXCIgbWVhbnMgXCJhbHJlYWR5IGxvYWRlZFwiXG52YXIgaW5zdGFsbGVkQ2h1bmtzID0ge1xuXHQ1NTk6IDFcbn07XG5cbi8vIGltcG9ydFNjcmlwdHMgY2h1bmsgbG9hZGluZ1xudmFyIGluc3RhbGxDaHVuayA9IChkYXRhKSA9PiB7XG5cdHZhciBbY2h1bmtJZHMsIG1vcmVNb2R1bGVzLCBydW50aW1lXSA9IGRhdGE7XG5cdGZvcih2YXIgbW9kdWxlSWQgaW4gbW9yZU1vZHVsZXMpIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8obW9yZU1vZHVsZXMsIG1vZHVsZUlkKSkge1xuXHRcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tW21vZHVsZUlkXSA9IG1vcmVNb2R1bGVzW21vZHVsZUlkXTtcblx0XHR9XG5cdH1cblx0aWYocnVudGltZSkgcnVudGltZShfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblx0d2hpbGUoY2h1bmtJZHMubGVuZ3RoKVxuXHRcdGluc3RhbGxlZENodW5rc1tjaHVua0lkcy5wb3AoKV0gPSAxO1xuXHRwYXJlbnRDaHVua0xvYWRpbmdGdW5jdGlvbihkYXRhKTtcbn07XG5fX3dlYnBhY2tfcmVxdWlyZV9fLmYuaSA9IChjaHVua0lkLCBwcm9taXNlcykgPT4ge1xuXHQvLyBcIjFcIiBpcyB0aGUgc2lnbmFsIGZvciBcImFscmVhZHkgbG9hZGVkXCJcblx0aWYoIWluc3RhbGxlZENodW5rc1tjaHVua0lkXSkge1xuXHRcdGlmKHRydWUpIHsgLy8gYWxsIGNodW5rcyBoYXZlIEpTXG5cdFx0XHRpbXBvcnRTY3JpcHRzKF9fd2VicGFja19yZXF1aXJlX18ucCArIF9fd2VicGFja19yZXF1aXJlX18udShjaHVua0lkKSk7XG5cdFx0fVxuXHR9XG59O1xuXG52YXIgY2h1bmtMb2FkaW5nR2xvYmFsID0gc2VsZltcIndlYnBhY2tDaHVua3NxbGl0ZV93YXNtX2h0dHBcIl0gPSBzZWxmW1wid2VicGFja0NodW5rc3FsaXRlX3dhc21faHR0cFwiXSB8fCBbXTtcbnZhciBwYXJlbnRDaHVua0xvYWRpbmdGdW5jdGlvbiA9IGNodW5rTG9hZGluZ0dsb2JhbC5wdXNoLmJpbmQoY2h1bmtMb2FkaW5nR2xvYmFsKTtcbmNodW5rTG9hZGluZ0dsb2JhbC5wdXNoID0gaW5zdGFsbENodW5rO1xuXG4vLyBubyBITVJcblxuLy8gbm8gSE1SIG1hbmlmZXN0IiwiLy8gcnVuIHN0YXJ0dXBcbnZhciBfX3dlYnBhY2tfZXhwb3J0c19fID0gX193ZWJwYWNrX3JlcXVpcmVfXy54KCk7XG4iXSwibmFtZXMiOlsiZGVmZXJyZWQiLCJuZXh0IiwiZGVmYXVsdE9wdGlvbnMiLCJ0aW1lb3V0IiwibWF4UGFnZVNpemUiLCJjYWNoZVNpemUiLCJoZWFkZXJzIiwiZGVidWdPcHRpb25zIiwiZGVidWdTeXMiLCJkZWJ1ZyIsImQiLCJpbmNsdWRlcyIsImNvbnNvbGUiLCJiaW5kIiwic3dhcE5lZWRlZCIsImFiIiwiQXJyYXlCdWZmZXIiLCJ1OCIsIlVpbnQ4QXJyYXkiLCJ1MTYiLCJVaW50MTZBcnJheSIsIkVycm9yIiwiX19hd2FpdGVyIiwidGhpc0FyZyIsIl9hcmd1bWVudHMiLCJQIiwiZ2VuZXJhdG9yIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJmdWxmaWxsZWQiLCJ2YWx1ZSIsInN0ZXAiLCJlIiwicmVqZWN0ZWQiLCJyZXN1bHQiLCJkb25lIiwidGhlbiIsImFwcGx5Iiwib3B0aW9ucyIsImNvbnN1bWVycyIsImZpbGVzIiwibWF4IiwiY2FjaGUiLCJuZXh0SWQiLCJiYWNrZW5kQXN5bmNNZXRob2RzIiwieE9wZW4iLCJtc2ciLCJ0aGlzIiwiZW50cnkiLCJnZXQiLCJ1cmwiLCJ1bmRlZmluZWQiLCJmZXRjaCIsIm1ldGhvZCIsIk9iamVjdCIsImFzc2lnbiIsImhlYWQiLCJfYSIsIndhcm4iLCJpZCIsInNpemUiLCJCaWdJbnQiLCJwYWdlU2l6ZSIsInNldCIsInhBY2Nlc3MiLCJjb25zdW1lciIsIlVpbnQzMkFycmF5Iiwic2htIiwiciIsInhSZWFkIiwiX2IiLCJfYyIsIm4iLCJvZmZzZXQiLCJwYWdlRGF0YUJ1ZmZlciIsImJ1ZmZlciIsInBhZ2VEYXRhIiwiZGF0YSIsImkiLCJsZW5ndGgiLCJudG9oMTYiLCJkZWxldGUiLCJsZW4iLCJwYWdlIiwicGFnZVN0YXJ0IiwiY2FjaGVJZCIsIm5ld1BhZ2VTdGFydCIsImNodW5rU2l6ZSIsInByZXYiLCJOdW1iZXIiLCJieXRlTGVuZ3RoIiwicGFnZXMiLCJyZXNwIiwiYXJyYXlCdWZmZXIiLCJKU09OIiwic3RyaW5naWZ5IiwicGFnZU9mZnNldCIsInN1YmFycmF5IiwieEZpbGVzaXplIiwiZmlkIiwiQmlnSW50NjRBcnJheSIsIndvcmtNZXNzYWdlIiwiQXRvbWljcyIsInN0b3JlIiwibG9jayIsImVycm9yIiwibm90aWZ5IiwiZ2xvYmFsVGhpcyIsIm9ubWVzc2FnZSIsIl9kIiwiU2hhcmVkQXJyYXlCdWZmZXIiLCJJbnQzMkFycmF5IiwiQllURVNfUEVSX0VMRU1FTlQiLCJwb3J0IiwicG9zdE1lc3NhZ2UiLCJtYXhTaXplIiwic2l6ZUNhbGN1bGF0aW9uIiwiY2xvc2UiLCJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJleHBvcnRzIiwibW9kdWxlIiwiX193ZWJwYWNrX21vZHVsZXNfXyIsIm0iLCJ4IiwiX193ZWJwYWNrX2V4cG9ydHNfXyIsIk8iLCJjaHVua0lkcyIsImZuIiwicHJpb3JpdHkiLCJub3RGdWxmaWxsZWQiLCJJbmZpbml0eSIsImoiLCJrZXlzIiwiZXZlcnkiLCJrZXkiLCJzcGxpY2UiLCJkZWZpbml0aW9uIiwibyIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImYiLCJjaHVua0lkIiwiYWxsIiwicmVkdWNlIiwicHJvbWlzZXMiLCJ1IiwiZyIsIkZ1bmN0aW9uIiwid2luZG93Iiwib2JqIiwicHJvcCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsInNjcmlwdFVybCIsImltcG9ydFNjcmlwdHMiLCJsb2NhdGlvbiIsImRvY3VtZW50IiwiY3VycmVudFNjcmlwdCIsInNyYyIsInNjcmlwdHMiLCJnZXRFbGVtZW50c0J5VGFnTmFtZSIsInJlcGxhY2UiLCJwIiwiaW5zdGFsbGVkQ2h1bmtzIiwiY2h1bmtMb2FkaW5nR2xvYmFsIiwic2VsZiIsInBhcmVudENodW5rTG9hZGluZ0Z1bmN0aW9uIiwicHVzaCIsIm1vcmVNb2R1bGVzIiwicnVudGltZSIsInBvcCJdLCJzb3VyY2VSb290IjoiIn0=