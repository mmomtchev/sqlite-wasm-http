(()=>{"use strict";var e,t,n={742:(e,t,n)=>{e.exports=n.p+"16ead312fb36d23af9fc.svg"}},r={};function o(e){var t=r[e];if(void 0!==t)return t.exports;var i=r[e]={exports:{}};return n[e](i,i.exports,o),i.exports}o.m=n,o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.f={},o.e=e=>Promise.all(Object.keys(o.f).reduce(((t,n)=>(o.f[n](e,t),t)),[])),o.u=e=>e+".bundle.js",o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="sqlite-wasm-http:",o.l=(n,r,i,s)=>{if(e[n])e[n].push(r);else{var a,l;if(void 0!==i)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==n||u.getAttribute("data-webpack")==t+i){a=u;break}}a||(l=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,o.nc&&a.setAttribute("nonce",o.nc),a.setAttribute("data-webpack",t+i),a.src=n),e[n]=[r];var p=(t,r)=>{a.onerror=a.onload=null,clearTimeout(m);var o=e[n];if(delete e[n],a.parentNode&&a.parentNode.removeChild(a),o&&o.forEach((e=>e(r))),t)return t(r)},m=setTimeout(p.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=p.bind(null,a.onerror),a.onload=p.bind(null,a.onload),l&&document.head.appendChild(a)}},o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;o.g.importScripts&&(e=o.g.location+"");var t=o.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var r=n.length-1;r>-1&&!e;)e=n[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),o.p=e})(),(()=>{o.b=document.baseURI||self.location.href;var e={179:0};o.f.j=(t,n)=>{var r=o.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var i=new Promise(((n,o)=>r=e[t]=[n,o]));n.push(r[2]=i);var s=o.p+o.u(t),a=new Error;o.l(s,(n=>{if(o.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var i=n&&("load"===n.type?"missing":n.type),s=n&&n.target&&n.target.src;a.message="Loading chunk "+t+" failed.\n("+i+": "+s+")",a.name="ChunkLoadError",a.type=i,a.request=s,r[1](a)}}),"chunk-"+t,t)}};var t=(t,n)=>{var r,i,[s,a,l]=n,c=0;if(s.some((t=>0!==e[t]))){for(r in a)o.o(a,r)&&(o.m[r]=a[r]);l&&l(o)}for(t&&t(n);c<s.length;c++)i=s[c],o.o(e,i)&&e[i]&&e[i][0](),e[i]=0},n=self.webpackChunksqlite_wasm_http=self.webpackChunksqlite_wasm_http||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),(()=>{globalThis.sqlite3Worker1Promiser=function e(t=e.defaultConfig){if(1===arguments.length&&"function"==typeof arguments[0]){const n=t;(t=Object.assign(Object.create(null),e.defaultConfig)).onready=n}else t=Object.assign(Object.create(null),e.defaultConfig,t);const n=Object.create(null),r=function(){},o=t.onerror||r,i=t.debug||r,s=t.generateMessageId?void 0:Object.create(null),a=t.generateMessageId||function(e){return e.type+"#"+(s[e.type]=(s[e.type]||0)+1)},l=(...e)=>{throw new Error(e.join(" "))};let c;return t.worker||(t.worker=e.defaultConfig.worker),"function"==typeof t.worker&&(t.worker=t.worker()),t.worker.onmessage=function(e){e=e.data,i("worker1.onmessage",e);let r=n[e.messageId];if(!r)return e&&"sqlite3-api"===e.type&&"worker1-ready"===e.result?void(t.onready&&t.onready()):(r=n[e.type],r&&r.onrow?void r.onrow(e):void(t.onunhandled?t.onunhandled(arguments[0]):o("sqlite3Worker1Promiser() unhandled worker message:",e)));switch(delete n[e.messageId],e.type){case"error":return void r.reject(e);case"open":c||(c=e.dbId);break;case"close":e.dbId===c&&(c=void 0)}try{r.resolve(e)}catch(e){r.reject(e)}},function(){let e;1===arguments.length?e=arguments[0]:2===arguments.length?(e=Object.create(null),e.type=arguments[0],e.args=arguments[1]):l("Invalid arugments for sqlite3Worker1Promiser()-created factory."),e.dbId||(e.dbId=c),e.messageId=a(e),e.departureTime=performance.now();const r=Object.create(null);let o;r.message=e,"exec"===e.type&&e.args&&("function"==typeof e.args.callback?(o=e.messageId+":row",r.onrow=e.args.callback,e.args.callback=o,n[o]=r):"string"==typeof e.args.callback&&l("exec callback may not be a string when using the Promise interface."));let s=new Promise((function(o,s){r.resolve=o,r.reject=s,n[e.messageId]=r,i("Posting",e.type,"message to Worker dbId="+(c||"default")+":",e),t.worker.postMessage(e)}));return o&&(s=s.finally((()=>delete n[o]))),s}},globalThis.sqlite3Worker1Promiser.defaultConfig={worker:function(){return new Worker(new URL(o.p+o.u(955),o.b),{type:void 0})},onerror:(...e)=>console.error("worker1 promiser error",...e)};const e={timeout:2e4,maxPageSize:4096,cacheSize:1024,headers:{}};var t;!function(e){e[e.WORKMSG=16777215]="WORKMSG",e[e.HANDSHAKE=16777214]="HANDSHAKE"}(t=t||(t={}));const n=[]||0,r=["threads","vfs","cache","http"],i={};for(const e of r)i[e]=n.includes(e)?console.debug.bind(console):()=>{};!function(){const e=new ArrayBuffer(2),t=new Uint8Array(e),n=new Uint16Array(e);if(t[0]=240,t[1]=13,61453==n[0])return i.threads("System is Big-Endian"),!1;if(3568==n[0])return i.threads("System is Little-Endian"),!0;throw new Error(`Failed determining endianness: ${n}`)}();const s='SharedArrayBuffer is not available. If your browser supports it, the webserver must send "Cross-Origin-Opener-Policy: same-origin "and "Cross-Origin-Embedder-Policy: require-corp" headers. Alternatively, if you do not intend to use concurrent connections, pass `sync` to `createHttpBackend` to explicitly create a synchronous HTTP backend and suppress this warning message.';var a=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{l(r.next(e))}catch(e){i(e)}}function a(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const l=new URL(o(742),o.b);!function(){a(this,void 0,void 0,(function*(){const t=function(t){if(i.threads("Creating new HTTP VFS backend thread"),"undefined"==typeof SharedArrayBuffer||"sync"===(null==t?void 0:t.backendType)){if("shared"===(null==t?void 0:t.backendType))throw new Error(s);return"sync"!==(null==t?void 0:t.backendType)&&console.warn(s+" Falling back to the legacy HTTP backend."),{type:"sync",worker:null,options:t,createNewChannel:()=>{throw new Error("Sync backend does not support channels")},close:()=>Promise.resolve(),terminate:()=>{}}}let n=1;const r=new Worker(new URL(o.p+o.u(559),o.b));r.postMessage({msg:"init",options:t});const a={};return r.onmessage=({data:e})=>{if(i.threads("Received control message reply",e),"ack"===e.msg)return a[e.id]?(i.threads("New HTTP VFS channel created",a),a[e.id].resolve({port:a[e.id].channel.port2,shm:e.shm}),clearTimeout(a[e.id].timeout),delete a[e.id].resolve,void delete a[e.id].timeout):void console.error("Invalid response received from backend",e)},{type:"shared",worker:r,options:t,createNewChannel:function(){i.threads("Creating a new HTTP VFS channel");const o=new MessageChannel,s=n++;return r.postMessage({msg:"handshake",port:o.port1,id:s},[o.port1]),new Promise(((n,r)=>{var i;const l=setTimeout((()=>{delete a[s],r("Timeout while waiting on backend")}),null!==(i=null==t?void 0:t.timeout)&&void 0!==i?i:e.timeout);a[s]={id:s,channel:o,resolve:n,timeout:l}}))},terminate:function(){r.terminate()},close:function(){return i.threads("Closing the HTTP VFS channel"),r.postMessage({msg:"close"}),new Promise(((n,o)=>{var s;const a=setTimeout((()=>{o("Timeout while waiting on backend")}),null!==(s=null==t?void 0:t.timeout)&&void 0!==s?s:e.timeout);r.onmessage=({data:e})=>{i.threads("Received close response",e),"ack"===e.msg&&void 0===e.id&&(n(),clearTimeout(a))}}))}}}({maxPageSize:4096,timeout:3e4});document.getElementById(`backend-${t.type}`).hidden=!1;const n=yield function(e){let t;return i.threads("Creating new SQLite thread",e),new Promise(((n,r)=>{const i=sqlite3Worker1Promiser({onready:()=>{n(i)},worker:()=>{try{t=new Worker(new URL(o.p+o.u(467),o.b)),t.onerror=e=>console.error("Worker bootstrap failed",e);const n=null==e?void 0:e.http;return"shared"===(null==n?void 0:n.type)?n.createNewChannel().then((e=>{t.postMessage({httpChannel:e,httpOptions:n.options},[e.port])})):"sync"===(null==n?void 0:n.type)?t.postMessage({httpChannel:!0,httpOptions:n.options}):t.postMessage({}),t}catch(e){console.error("Failed to create SQLite worker",e),r(e)}}})})).then((e=>(e.close=()=>{t.terminate()},e)))}({http:t}),r=document.getElementById("input-url"),c=document.getElementById("input-sql"),d=document.getElementById("btn-go"),u=document.getElementById("btn-config"),p=document.getElementById("results"),m=document.getElementById("msg");r.value="https://velivole.b-cdn.net/maptiler-osm-2017-07-03-v3.6.1-europe.mbtiles",c.value="SELECT zoom_level, tile_row, tile_column FROM tiles WHERE zoom_level = 1",u.addEventListener("click",(()=>a(this,void 0,void 0,(function*(){m.innerHTML=`<img src="${l}">`;const e=yield n("config-get",{});m.innerHTML=JSON.stringify(e,null,4),p.innerHTML=""}))));for(const e of Array.from(document.getElementsByClassName("example-sql")))e.addEventListener("click",(e=>{c.value=e.target.innerText}));d.addEventListener("click",(()=>a(this,void 0,void 0,(function*(){var e;m.innerHTML=`<img src="${l}">`,p.innerHTML=`<img id="spinner-results" src="${l}">`;try{const e=yield n("open",{filename:"file:"+encodeURI(r.value),vfs:"http"});m.innerHTML=JSON.stringify(e,null,4);const t=yield n("exec",{sql:c.value,callback:function(e){e.row?p.innerHTML+=`<div>row: ${JSON.stringify(e,null,4)}</div>`:document.getElementById("spinner-results").hidden=!0}});m.innerHTML+=JSON.stringify(t,null,4);const o=yield n("close",{});m.innerHTML+=JSON.stringify(o,null,4)}catch(t){(null===(e=t.result)||void 0===e?void 0:e.message)?m.innerHTML=t.result.message:m.innerHTML=t.toString()}}))))}))}()})()})();
//# sourceMappingURL=main.bundle.js.map